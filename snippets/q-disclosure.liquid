{% comment %}
  Quadratum â€” q-disclosure (primitive)
  File: snippets/q-disclosure.liquid

  Purpose:
  - Reusable disclosure wrapper (mobile collapse blocks, FAQ groups, filters, etc.)
  - Accessible baseline without JS (details/summary)
  - Token/CSS-var driven via inline vars or parent scope

  Contract:
  {% capture panel %}
    ...content...
  {% endcapture %}

  {% render 'q-disclosure',
    id: 'toc-mobile-1',                 (recommended)
    mode: 'details',                   ('details' default | 'button')
    summary: 'On this page',
    open: false,                       (default false)
    summary_class: 'q-toc__summary',    (optional)
    panel_class: 'q-toc__panel',        (optional)
    root_class: 'q-toc__disclosure',    (optional)
    toggle_open_label: 'Show sections', (optional)
    toggle_close_label: 'Hide sections',(optional)
    content: panel
  %}

  Notes:
  - In `button` mode, aria-expanded + aria-controls are output.
  - You can add a tiny JS enhancer later to toggle [hidden] on the panel.
{% endcomment %}

{%- liquid
  assign id = id | default: ''
  assign mode = mode | default: 'details'
  assign summary = summary | default: ''

  assign open = open | default: false

  assign root_class = root_class | default: 'q-disclosure'
  assign summary_class = summary_class | default: 'q-disclosure__summary'
  assign panel_class = panel_class | default: 'q-disclosure__panel'

  assign toggle_open_label = toggle_open_label | default: ''
  assign toggle_close_label = toggle_close_label | default: ''

  assign content = content | default: ''
-%}

{%- if mode == 'button' -%}
  {%- liquid
    assign panel_id = ''
    if id != blank
      assign panel_id = id | append: '-panel'
    else
      assign panel_id = 'q-disclosure-panel'
    endif

    assign expanded_str = 'false'
    if open
      assign expanded_str = 'true'
    endif
  -%}

  <div class="{{ root_class }}" {% if id != blank %}id="{{ id | escape }}"{% endif %} data-q-disclosure data-q-disclosure-mode="button">
    <button
      type="button"
      class="{{ summary_class }}"
      aria-expanded="{{ expanded_str }}"
      aria-controls="{{ panel_id | escape }}"
      data-q-disclosure-toggle
    >
      <span class="q-disclosure__summary-text">{{ summary }}</span>

      {%- if toggle_open_label != blank or toggle_close_label != blank -%}
        <span class="q-disclosure__toggle">
          {%- if toggle_open_label != blank -%}
            <span class="q-disclosure__toggle-open">{{ toggle_open_label }}</span>
          {%- endif -%}
          {%- if toggle_close_label != blank -%}
            <span class="q-disclosure__toggle-close">{{ toggle_close_label }}</span>
          {%- endif -%}
        </span>
      {%- endif -%}
    </button>

    <div
      class="{{ panel_class }}"
      id="{{ panel_id | escape }}"
      {% unless open %}hidden{% endunless %}
      data-q-disclosure-panel
    >
      {{ content }}
    </div>
  </div>

{%- else -%}
  <details class="{{ root_class }}" {% if id != blank %}id="{{ id | escape }}"{% endif %} data-q-disclosure data-q-disclosure-mode="details" {% if open %}open{% endif %}>
    <summary class="{{ summary_class }}">
      <span class="q-disclosure__summary-text">{{ summary }}</span>

      {%- if toggle_open_label != blank or toggle_close_label != blank -%}
        <span class="q-disclosure__toggle">
          {%- if toggle_open_label != blank -%}
            <span class="q-disclosure__toggle-open">{{ toggle_open_label }}</span>
          {%- endif -%}
          {%- if toggle_close_label != blank -%}
            <span class="q-disclosure__toggle-close">{{ toggle_close_label }}</span>
          {%- endif -%}
        </span>
      {%- endif -%}
    </summary>

    <div class="{{ panel_class }}" data-q-disclosure-panel>
      {{ content }}
    </div>
  </details>
{%- endif -%}
