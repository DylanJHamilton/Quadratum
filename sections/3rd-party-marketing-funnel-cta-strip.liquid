{% comment %}
  Quadratum — 3rd Party · Marketing Funnel CTA Strip (External)
  File: sections/3p-marketing-funnel-cta-strip.liquid

  Premium on-site CTA strip that links out to external funnels (GHL / ClickFunnels / Leadpages / etc.)
  Styling is Quadratum-native; funnel styling is external after click.
{% endcomment %}

{%- assign s = section.settings -%}
{%- assign g = settings -%}

{%- if s.enable_section -%}

  {%- comment -%} URLs: safe defaults (schema url defaults can be flaky across themes) {%- endcomment -%}
  {%- assign primary_url = s.primary_button_url | default: '/pages/funnel' -%}
  {%- assign secondary_url = s.secondary_button_url | default: '/pages/how-it-works' -%}

  {%- comment -%} Button variants (inherit-aware, maps to Quadratum q-btn--*) {%- endcomment -%}
  {%- assign global_btn_variant = g.button_variant_default | default: 'solid' -%}

  {%- assign _p_variant = s.primary_button_variant | default: 'inherit' -%}
  {%- if _p_variant == blank or _p_variant == 'inherit' -%}{%- assign _p_variant = global_btn_variant -%}{%- endif -%}
  {%- assign p_btn_class = 'q-btn--solid' -%}
  {%- if _p_variant == 'outline' -%}{%- assign p_btn_class = 'q-btn--outline' -%}{%- endif -%}
  {%- if _p_variant == 'ghost' -%}{%- assign p_btn_class = 'q-btn--ghost' -%}{%- endif -%}

  {%- assign _s_variant = s.secondary_button_variant | default: 'ghost' -%}
  {%- if _s_variant == blank or _s_variant == 'inherit' -%}{%- assign _s_variant = global_btn_variant -%}{%- endif -%}
  {%- assign s_btn_class = 'q-btn--ghost' -%}
  {%- if _s_variant == 'solid' -%}{%- assign s_btn_class = 'q-btn--solid' -%}{%- endif -%}
  {%- if _s_variant == 'outline' -%}{%- assign s_btn_class = 'q-btn--outline' -%}{%- endif -%}

  {%- comment -%} Button size {%- endcomment -%}
  {%- assign btn_size = s.button_size | default: 'md' -%}
  {%- assign btn_size_class = 'q-btn--md' -%}
  {%- if btn_size == 'sm' -%}{%- assign btn_size_class = 'q-btn--sm' -%}{%- endif -%}
  {%- if btn_size == 'lg' -%}{%- assign btn_size_class = 'q-btn--lg' -%}{%- endif -%}

  {%- assign has_primary = false -%}
  {%- if s.primary_button_label != blank and primary_url != blank -%}{%- assign has_primary = true -%}{%- endif -%}
  {%- assign has_secondary = false -%}
  {%- if s.secondary_button_label != blank and secondary_url != blank -%}{%- assign has_secondary = true -%}{%- endif -%}

<section
  class="q-section q-section--bg-{{ s.background_style }} q-cta-strip q-cta-strip--funnel q-cta-strip--{{ s.layout_style }}{% if s.show_border %} q-cta-strip--bordered{% endif %}"
  aria-label="{{ s.aria_label | escape }}"
  {% if s.enable_custom_button_colors %}data-custom-btn="1"{% endif %}
  style="
    --q-cta-primary-bg: {{ s.primary_btn_bg }};
    --q-cta-primary-text: {{ s.primary_btn_text }};
    --q-cta-secondary-bg: {{ s.secondary_btn_bg }};
    --q-cta-secondary-text: {{ s.secondary_btn_text }};
    --q-cta-secondary-border: {{ s.secondary_btn_border }};
  "
>
  <div class="q-section__inner q-section__inner--{{ s.max_width }} q-cta-strip__inner q-align-{{ s.align }}">
    {%- if s.layout_style == 'card' -%}
      <div class="q-cta-strip__card">
    {%- endif -%}

      <div class="q-cta-strip__layout">
        <div class="q-cta-strip__content">
          {%- if s.kicker != blank -%}
            <p class="q-kicker q-cta-strip__kicker">{{ s.kicker | escape }}</p>
          {%- endif -%}

          {%- if s.heading != blank -%}
            <h2 class="q-heading q-heading--section q-cta-strip__heading">
              {{ s.heading | escape }}
            </h2>
          {%- endif -%}

          {%- if s.body != blank -%}
            <div class="q-text q-cta-strip__body">
              {{ s.body }}
            </div>
          {%- endif -%}
        </div>

        {%- if has_primary or has_secondary -%}
          <div class="q-cta-strip__actions" role="group" aria-label="Call to action buttons">
            {%- if has_primary -%}
              <a
                href="{{ primary_url }}"
                class="q-btn {{ p_btn_class }} {{ btn_size_class }} q-cta-strip__btn q-cta-strip__btn--primary"
                {%- if s.open_in_new_tab -%}target="_blank" rel="noopener noreferrer"{%- endif -%}
              >
                <span class="q-cta-strip__btn-text">{{ s.primary_button_label | escape }}</span>
                {%- if s.show_icon_hint -%}
                  <span class="q-cta-strip__icon" aria-hidden="true">
                    <svg viewBox="0 0 20 20" focusable="false" aria-hidden="true">
                      <path d="M11.2 3.5h5.3v5.3a.9.9 0 1 1-1.8 0V6.7l-7.2 7.2a.9.9 0 0 1-1.3-1.3l7.2-7.2h-2.2a.9.9 0 1 1 0-1.9Z"/>
                      <path d="M4.5 6.8c0-1.3 1-2.3 2.3-2.3h2.3a.9.9 0 1 1 0 1.8H6.8c-.3 0-.5.2-.5.5v8c0 .3.2.5.5.5h8c.3 0 .5-.2.5-.5v-2.3a.9.9 0 1 1 1.8 0v2.3c0 1.3-1 2.3-2.3 2.3h-8a2.3 2.3 0 0 1-2.3-2.3v-8Z"/>
                    </svg>
                  </span>
                {%- endif -%}
              </a>
            {%- endif -%}

            {%- if has_secondary -%}
              <a
                href="{{ secondary_url }}"
                class="q-btn {{ s_btn_class }} {{ btn_size_class }} q-cta-strip__btn q-cta-strip__btn--secondary"
                {%- if s.open_in_new_tab -%}target="_blank" rel="noopener noreferrer"{%- endif -%}
              >
                <span class="q-cta-strip__btn-text">{{ s.secondary_button_label | escape }}</span>
              </a>
            {%- endif -%}
          </div>
        {%- endif -%}
      </div>

      {%- if s.show_funnel_tag and s.funnel_tag_text != blank -%}
        <p class="q-meta q-cta-strip__meta">{{ s.funnel_tag_text | escape }}</p>
      {%- endif -%}

    {%- if s.layout_style == 'card' -%}
      </div>
    {%- endif -%}
  </div>

  <style>
    /* Scoped CTA styling (premium by default, but respects global q-btn if present) */
    .q-cta-strip--funnel{
      position: relative;
      padding: var(--q-space-xl, 48px) 0;
      overflow: hidden;
    }

    .q-cta-strip--funnel .q-cta-strip__inner{
      padding-left: var(--q-space-lg, 24px);
      padding-right: var(--q-space-lg, 24px);
    }

    .q-cta-strip--funnel .q-align-left{ text-align:left; }
    .q-cta-strip--funnel .q-align-center{ text-align:center; }

    .q-cta-strip--funnel .q-cta-strip__layout{
      display: grid;
      gap: var(--q-space-lg, 24px);
      align-items: center;
      padding: var(--q-space-lg, 24px);
      border-radius: var(--q-radius-lg, 18px);
      background: var(--q-surface, rgba(255,255,255,0.70));
      box-shadow: 0 10px 30px rgba(0,0,0,.06);
      position: relative;
    }

    .q-cta-strip--funnel.q-cta-strip--hero{
      padding: calc(var(--q-space-xl, 48px) * 1.15) 0;
    }
    .q-cta-strip--funnel.q-cta-strip--hero .q-cta-strip__layout{
      padding: calc(var(--q-space-xl, 48px) * .95) var(--q-space-lg, 24px);
    }

    .q-cta-strip--funnel.q-cta-strip--strip .q-cta-strip__layout::before,
    .q-cta-strip--funnel.q-cta-strip--hero  .q-cta-strip__layout::before{
      content:"";
      position:absolute; inset:0;
      border-radius:inherit;
      pointer-events:none;
      background: linear-gradient(180deg, rgba(255,255,255,.22), rgba(255,255,255,0));
      opacity:.9;
    }

    .q-cta-strip--funnel.q-cta-strip--bordered .q-cta-strip__layout,
    .q-cta-strip--funnel.q-cta-strip--bordered .q-cta-strip__card{
      border: 1px solid var(--q-border, rgba(0,0,0,.10));
    }

    .q-cta-strip--funnel .q-cta-strip__card{
      padding: var(--q-space-lg, 24px);
      border-radius: var(--q-radius-lg, 18px);
      background: var(--q-surface, #ffffff);
      box-shadow: 0 18px 50px rgba(0,0,0,.10);
    }

    .q-cta-strip--funnel .q-cta-strip__content{
      display: grid;
      gap: var(--q-space-sm, 12px);
      position: relative;
      z-index: 1;
    }

    .q-cta-strip--funnel .q-cta-strip__kicker{ margin:0; font-weight:600; opacity:.9; }
    .q-cta-strip--funnel .q-cta-strip__heading{ margin:0; line-height:1.08; }
    .q-cta-strip--funnel.q-cta-strip--hero .q-cta-strip__heading{
      font-size: clamp(1.8rem, 2.6vw, 2.5rem);
    }

    .q-cta-strip--funnel .q-cta-strip__body{ margin:0; opacity:.95; max-width: 60ch; }
    .q-cta-strip--funnel .q-align-center .q-cta-strip__body{ margin-left:auto; margin-right:auto; }

    .q-cta-strip--funnel .q-cta-strip__actions{
      display:flex;
      gap: var(--q-space-sm, 12px);
      flex-wrap: wrap;
      justify-content: center;
      align-items:center;
      position: relative;
      z-index: 1;
    }
    .q-cta-strip--funnel .q-align-left .q-cta-strip__actions{ justify-content:flex-start; }

    /* Size helpers (only if your global CSS doesn’t already define q-btn--sm/md/lg) */
    .q-cta-strip--funnel .q-btn.q-btn--sm{ padding: .65rem .9rem; font-size: .95rem; }
    .q-cta-strip--funnel .q-btn.q-btn--md{ padding: .85rem 1.05rem; font-size: 1rem; }
    .q-cta-strip--funnel .q-btn.q-btn--lg{ padding: 1rem 1.2rem; font-size: 1.05rem; }

    .q-cta-strip--funnel .q-cta-strip__icon{ display:inline-flex; width:1.05rem; height:1.05rem; opacity:.95; }
    .q-cta-strip--funnel .q-cta-strip__icon svg{ width:100%; height:100%; fill: currentColor; display:block; }

    /* Optional per-section custom button colors */
    .q-cta-strip--funnel[data-custom-btn="1"] .q-cta-strip__btn--primary{
      background: var(--q-cta-primary-bg);
      color: var(--q-cta-primary-text);
      border-color: rgba(0,0,0,0);
    }
    .q-cta-strip--funnel[data-custom-btn="1"] .q-cta-strip__btn--secondary{
      background: var(--q-cta-secondary-bg);
      color: var(--q-cta-secondary-text);
      border-color: var(--q-cta-secondary-border);
    }

    @media (min-width: 768px){
      .q-cta-strip--funnel .q-align-left .q-cta-strip__layout{
        grid-template-columns: 1fr auto;
        column-gap: var(--q-space-xl, 32px);
      }
      .q-cta-strip--funnel .q-align-left .q-cta-strip__actions{ justify-content:flex-end; }
    }

    @media (max-width: 767.98px){
      .q-cta-strip--funnel .q-btn{ width: 100%; justify-content:center; }
      .q-cta-strip--funnel .q-cta-strip__actions{ width:100%; }
    }
  </style>
</section>

{%- endif -%}

{% schema %}
{
  "name": "3P - Marketing Funnel",
  "class": "q-section-wrap q-section-wrap--cta-strip q-section-wrap--funnel",
  "settings": [
    { "type": "checkbox", "id": "enable_section", "label": "Enable section", "default": true },
    { "type": "text", "id": "aria_label", "label": "Section aria-label", "default": "Marketing funnel call-to-action" },

    { "type": "text", "id": "kicker", "label": "Kicker", "default": "Want the full plan?" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Unlock the complete funnel experience" },
    {
      "type": "richtext",
      "id": "body",
      "label": "Body text",
      "default": "<p>Get the complete strategy, follow-up automations, and bonus resources inside our dedicated funnel experience.</p>"
    },

    { "type": "header", "content": "CTA buttons" },
    { "type": "text", "id": "primary_button_label", "label": "Primary button label", "default": "Open the funnel" },
    { "type": "url", "id": "primary_button_url", "label": "Primary button link" },
    { "type": "text", "id": "secondary_button_label", "label": "Secondary button label", "default": "Learn more" },
    { "type": "url", "id": "secondary_button_url", "label": "Secondary button link" },
    { "type": "checkbox", "id": "open_in_new_tab", "label": "Open links in a new tab", "default": true },
    { "type": "checkbox", "id": "show_icon_hint", "label": "Show small arrow/launch icon on primary button", "default": true },

    { "type": "header", "content": "Button styling" },
    {
      "type": "select",
      "id": "button_size",
      "label": "Button size",
      "default": "md",
      "options": [
        { "value": "sm", "label": "Small" },
        { "value": "md", "label": "Medium" },
        { "value": "lg", "label": "Large" }
      ]
    },
    {
      "type": "select",
      "id": "primary_button_variant",
      "label": "Primary button style",
      "default": "inherit",
      "options": [
        { "value": "inherit", "label": "Inherit (theme default)" },
        { "value": "solid", "label": "Solid" },
        { "value": "outline", "label": "Outline" },
        { "value": "ghost", "label": "Ghost" }
      ]
    },
    {
      "type": "select",
      "id": "secondary_button_variant",
      "label": "Secondary button style",
      "default": "ghost",
      "options": [
        { "value": "inherit", "label": "Inherit (theme default)" },
        { "value": "solid", "label": "Solid" },
        { "value": "outline", "label": "Outline" },
        { "value": "ghost", "label": "Ghost" }
      ]
    },

    { "type": "header", "content": "Custom button colors (optional)" },
    { "type": "checkbox", "id": "enable_custom_button_colors", "label": "Enable custom button colors", "default": false },
    { "type": "color", "id": "primary_btn_bg", "label": "Primary button background", "default": "#111111" },
    { "type": "color", "id": "primary_btn_text", "label": "Primary button text", "default": "#ffffff" },
    { "type": "color", "id": "secondary_btn_bg", "label": "Secondary button background", "default": "#ffffff" },
    { "type": "color", "id": "secondary_btn_text", "label": "Secondary button text", "default": "#111111" },
    { "type": "color", "id": "secondary_btn_border", "label": "Secondary button border", "default": "#111111" },

    { "type": "header", "content": "Funnel meta / tag" },
    { "type": "checkbox", "id": "show_funnel_tag", "label": "Show funnel provider label", "default": false },
    { "type": "text", "id": "funnel_tag_text", "label": "Funnel provider text", "default": "Powered by our GoHighLevel funnel" },

    { "type": "header", "content": "Layout & style" },
    {
      "type": "select",
      "id": "layout_style",
      "label": "Layout style",
      "default": "strip",
      "options": [
        { "value": "strip", "label": "Strip" },
        { "value": "card", "label": "Card" },
        { "value": "hero", "label": "Hero" }
      ]
    },
    {
      "type": "select",
      "id": "align",
      "label": "Content alignment",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" }
      ]
    },
    {
      "type": "select",
      "id": "background_style",
      "label": "Background style",
      "default": "brand",
      "options": [
        { "value": "surface", "label": "Surface" },
        { "value": "contrast", "label": "Contrast" },
        { "value": "brand", "label": "Brand" }
      ]
    },
    {
      "type": "select",
      "id": "max_width",
      "label": "Max content width",
      "default": "md",
      "options": [
        { "value": "sm", "label": "sm" },
        { "value": "md", "label": "md" },
        { "value": "lg", "label": "lg" }
      ]
    },
    { "type": "checkbox", "id": "show_border", "label": "Show subtle border", "default": false }
  ],
  "presets": [
    {
      "name": "3rd Party - Marketing Funnel CTA",
      "category": "3rd Party & Funnels",
      "settings": {
        "kicker": "Want the full plan?",
        "heading": "See the complete strategy in our funnel",
        "body": "<p>Walk through the full experience with guided steps, follow-up reminders, and bonus resources tailored to you.</p>",
        "primary_button_label": "Open the funnel",
        "secondary_button_label": "Learn more",
        "layout_style": "strip",
        "align": "center",
        "background_style": "brand",
        "max_width": "md",
        "open_in_new_tab": true,
        "show_icon_hint": true,
        "show_funnel_tag": false,
        "funnel_tag_text": "Powered by our GoHighLevel funnel",
        "button_size": "md",
        "primary_button_variant": "inherit",
        "secondary_button_variant": "ghost",
        "enable_custom_button_colors": false
      }
    }
  ]
}
{% endschema %}
