{% comment %}
  Quadratum — Social Media: UGC Gallery / Hashtag Gallery

  Purpose:
  • Manual social / hashtag gallery (no API)
  • Merchant uploads images, sets captions, optional links to original posts
  • Optional social network badge (IG, TikTok, FB, etc.)
{% endcomment %}

{%- assign s = section.settings -%}

{%- style -%}
  .q-social-ugc-gallery {
    padding-block: var(--q-section-pad-y, 3rem);
  }

  .q-social-ugc-gallery--bg-default {
    background-color: var(--bg_base, #ffffff);
    color: var(--text_base, #111111);
  }

  .q-social-ugc-gallery--bg-subtle {
    background-color: var(--bg_contrast, #f6f7f8);
    color: var(--text_base, #111111);
  }

  .q-social-ugc-gallery--bg-emphasis {
    background-color: var(--color_primary, #2563eb);
    color: var(--text_on_color, #ffffff);
  }

  .q-social-ugc-gallery__inner {
    max-width: var(--q-container-lg, 1152px);
    margin-inline: auto;
    padding-inline: var(--q-container-pad-x, 1.25rem);
  }

  .q-social-ugc-gallery__header {
    max-width: 40rem;
    margin-inline: auto;
    margin-bottom: var(--space-md, 1.5rem);
  }

  .q-social-ugc-gallery--align-left .q-social-ugc-gallery__header {
    margin-inline: 0;
    text-align: left;
  }

  .q-social-ugc-gallery--align-center .q-social-ugc-gallery__header {
    text-align: center;
  }

  .q-social-ugc-gallery--align-right .q-social-ugc-gallery__header {
    margin-inline: 0 0 0 auto;
    text-align: right;
  }

  .q-social-ugc-gallery__kicker {
    font-size: 0.75rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin: 0 0 0.25rem;
    opacity: 0.75;
  }

  .q-social-ugc-gallery__heading {
    margin: 0 0 0.25rem;
    font-size: var(--text-2xl, 1.5rem);
    line-height: 1.2;
  }

  .q-social-ugc-gallery__body {
    margin: 0;
    font-size: var(--text-base, 1rem);
    line-height: 1.5;
    opacity: 0.9;
  }

  .q-social-ugc-gallery__grid {
    display: grid;
    gap: var(--q-ugc-gap, 12px);
  }

  @media (max-width: 639.98px) {
    .q-social-ugc-gallery__inner {
      padding-inline: 1rem;
    }
  }

  @media (min-width: 0px) {
    .q-social-ugc-gallery__grid {
      grid-template-columns: repeat(var(--q-ugc-cols-mobile, 2), minmax(0, 1fr));
    }
  }

  @media (min-width: 768px) {
    .q-social-ugc-gallery__grid {
      grid-template-columns: repeat(var(--q-ugc-cols-tablet, 3), minmax(0, 1fr));
    }
  }

  @media (min-width: 1024px) {
    .q-social-ugc-gallery__grid {
      grid-template-columns: repeat(var(--q-ugc-cols-desktop, 4), minmax(0, 1fr));
    }
  }

  .q-social-ugc-gallery--layout-stacked .q-social-ugc-gallery__grid {
    grid-template-columns: 1fr !important;
  }

  .q-social-ugc-gallery__item {
    list-style: none;
  }

  .q-social-ugc-gallery__tile {
    position: relative;
    overflow: hidden;
    border-radius: var(--q-radius-ugc, 16px);
    background-color: var(--bg_contrast, #f6f7f8);
    color: inherit;
    text-decoration: none;
    display: block;
  }

  .q-social-ugc-gallery__tile:focus-visible {
    outline: 2px solid var(--color_primary, #2563eb);
    outline-offset: 2px;
  }

  .q-social-ugc-gallery__media {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  .q-social-ugc-gallery__media-inner {
    width: 100%;
    height: 100%;
    position: relative;
  }

  .q-social-ugc-gallery__media-inner--square {
    aspect-ratio: 1 / 1;
  }

  .q-social-ugc-gallery__media-inner--portrait {
    aspect-ratio: 4 / 5;
  }

  .q-social-ugc-gallery__media-inner--landscape {
    aspect-ratio: 3 / 2;
  }

  .q-social-ugc-gallery__media-inner img {
    width: 100%;
    height: 100%;
    display: block;
    object-fit: cover;
  }

  .q-social-ugc-gallery__badge {
    position: absolute;
    top: 0.75rem;
    left: 0.75rem;
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    padding: 0.25rem 0.6rem;
    border-radius: 999px;
    font-size: 0.75rem;
    line-height: 1;
    background-color: rgba(0, 0, 0, 0.6);
    color: #ffffff;
    z-index: 2;
  }

  .q-social-ugc-gallery--bg-emphasis .q-social-ugc-gallery__badge {
    background-color: rgba(15, 23, 42, 0.8);
  }

  .q-social-ugc-gallery__badge-icon {
    width: 14px;
    height: 14px;
    display: inline-flex;
  }

  .q-social-ugc-gallery__badge-handle {
    white-space: nowrap;
  }

  /* Hover style: overlay */
  .q-social-ugc-gallery--hover-overlay .q-social-ugc-gallery__tile {
    cursor: pointer;
  }

  .q-social-ugc-gallery__overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.1));
    color: #ffffff;
    opacity: 0;
    transition: opacity 160ms ease-out;
    display: flex;
    align-items: flex-end;
    padding: 0.75rem 0.9rem;
    z-index: 1;
  }

  .q-social-ugc-gallery__tile:hover .q-social-ugc-gallery__overlay,
  .q-social-ugc-gallery__tile:focus-visible .q-social-ugc-gallery__overlay {
    opacity: 1;
  }

  .q-social-ugc-gallery__overlay-content {
    font-size: 0.8rem;
    line-height: 1.4;
    max-height: 70%;
    overflow: hidden;
  }

  .q-social-ugc-gallery__overlay-caption {
    margin: 0;
  }

  .q-social-ugc-gallery__overlay-link-label {
    display: inline-block;
    margin-top: 0.25rem;
    font-weight: 600;
  }

  /* Hover style: lift */
  .q-social-ugc-gallery--hover-lift .q-social-ugc-gallery__tile {
    transition: transform 140ms ease, box-shadow 140ms ease;
  }

  .q-social-ugc-gallery--hover-lift .q-social-ugc-gallery__tile:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(15, 23, 42, 0.18);
  }

  .q-social-ugc-gallery__caption-below {
    margin-top: 0.5rem;
    font-size: 0.85rem;
    line-height: 1.4;
  }

  /* Hover style: none */
  .q-social-ugc-gallery--hover-none .q-social-ugc-gallery__overlay {
    display: none;
  }

  .q-social-ugc-gallery__item--featured {
    /* Optional: let featured span more columns on desktop */
  }

  @media (min-width: 1024px) {
    .q-social-ugc-gallery__item--featured {
      grid-column: span 2;
    }
  }

  .q-ugc-visually-hidden {
    position: absolute !important;
    width: 1px !important;
    height: 1px !important;
    padding: 0 !important;
    margin: -1px !important;
    overflow: hidden !important;
    clip: rect(0, 0, 0, 0) !important;
    white-space: nowrap !important;
    border: 0 !important;
  }
{%- endstyle -%}

{%- assign bg_class = 'q-social-ugc-gallery--bg-default' -%}
{%- case s.bg_scheme -%}
  {%- when 'subtle' -%}
    {%- assign bg_class = 'q-social-ugc-gallery--bg-subtle' -%}
  {%- when 'emphasis' -%}
    {%- assign bg_class = 'q-social-ugc-gallery--bg-emphasis' -%}
{%- endcase -%}

{%- assign hover_class = 'q-social-ugc-gallery--hover-overlay' -%}
{%- case s.hover_style -%}
  {%- when 'lift' -%}
    {%- assign hover_class = 'q-social-ugc-gallery--hover-lift' -%}
  {%- when 'none' -%}
    {%- assign hover_class = 'q-social-ugc-gallery--hover-none' -%}
{%- endcase -%}

<section
  class="
    q-social-ugc-gallery
    {{ bg_class }}
    {{ hover_class }}
    q-social-ugc-gallery--align-{{ s.align }}
    q-social-ugc-gallery--layout-{{ s.layout_variant }}
  "
  style="
    --q-ugc-cols-mobile: {{ s.cols_mobile }};
    --q-ugc-cols-tablet: {{ s.cols_tablet }};
    --q-ugc-cols-desktop: {{ s.cols_desktop }};
    --q-ugc-gap: {{ s.gap }}px;
  "
  aria-label="{{ s.aria_label | escape }}"
>
  <div class="q-social-ugc-gallery__inner">
    {%- if s.kicker != blank or s.heading != blank or s.body != blank -%}
      <div class="q-social-ugc-gallery__header">
        {%- if s.kicker != blank -%}
          <p class="q-social-ugc-gallery__kicker">
            {{ s.kicker | escape }}
          </p>
        {%- endif -%}
        {%- if s.heading != blank -%}
          <h2 class="q-social-ugc-gallery__heading">
            {{ s.heading | escape }}
          </h2>
        {%- endif -%}
        {%- if s.show_body and s.body != blank -%}
          <p class="q-social-ugc-gallery__body">
            {{ s.body }}
          </p>
        {%- endif -%}
      </div>
    {%- endif -%}

    {%- if section.blocks.size > 0 -%}
      <ul class="q-social-ugc-gallery__grid" role="list">
        {%- for block in section.blocks -%}
          {%- if block.type == 'ugc_item' -%}
            {%- assign b = block.settings -%}
            {%- if b.image != blank -%}
              {%- assign has_link = false -%}
              {%- if b.link_url != blank and b.link_url != '#' -%}
                {%- assign has_link = true -%}
              {%- endif -%}

              {%- assign network_label = '' -%}
              {%- case b.network -%}
                {%- when 'instagram' -%}{%- assign network_label = 'Instagram' -%}
                {%- when 'tiktok' -%}{%- assign network_label = 'TikTok' -%}
                {%- when 'facebook' -%}{%- assign network_label = 'Facebook' -%}
                {%- when 'pinterest' -%}{%- assign network_label = 'Pinterest' -%}
                {%- when 'youtube' -%}{%- assign network_label = 'YouTube' -%}
                {%- when 'twitter' -%}{%- assign network_label = 'Twitter' -%}
                {%- else -%}{%- assign network_label = 'Social' -%}
              {%- endcase -%}

              {%- assign icon_name = b.network | default: 'instagram' -%}

              {%- assign clean_caption = b.caption | strip_html | strip_newlines -%}
              {%- assign sr_base = b.link_label | default: 'View post' -%}
              {%- assign sr_text = sr_base -%}
              {%- if clean_caption != blank -%}
                {%- assign sr_text = sr_base | append: ': ' | append: clean_caption | truncate: 80 -%}
              {%- endif -%}

              <li
                class="q-social-ugc-gallery__item{% if b.pin_featured %} q-social-ugc-gallery__item--featured{% endif %}"
                {{ block.shopify_attributes }}
              >
                {%- if has_link -%}
                  <a
                    href="{{ b.link_url }}"
                    class="q-social-ugc-gallery__tile"
                    aria-label="{{ sr_text | escape }}"
                    {% if s.open_in_new_tab %}
                      target="_blank"
                      rel="noopener noreferrer"
                    {% endif %}
                  >
                {%- else -%}
                  <div class="q-social-ugc-gallery__tile">
                {%- endif -%}

                  <div class="q-social-ugc-gallery__media">
                    <div class="q-social-ugc-gallery__media-inner">
                      <div
                        class="
                          q-social-ugc-gallery__media-inner
                          {%- if s.aspect_ratio == 'square' -%} q-social-ugc-gallery__media-inner--square{%- endif -%}
                          {%- if s.aspect_ratio == 'portrait' -%} q-social-ugc-gallery__media-inner--portrait{%- endif -%}
                          {%- if s.aspect_ratio == 'landscape' -%} q-social-ugc-gallery__media-inner--landscape{%- endif -%}
                        "
                      >
                        {{ b.image | image_url: width: 1200 | image_tag:
                          loading: 'lazy',
                          decoding: 'async',
                          alt: clean_caption | default: network_label
                        }}
                      </div>
                    </div>

                    {%- if s.show_social_badge -%}
                      {%- if b.handle != blank or network_label != blank -%}
                        <div class="q-social-ugc-gallery__badge">
                          <span class="q-social-ugc-gallery__badge-icon">
                            {% render 'icon-social', name: icon_name %}
                          </span>
                          <span class="q-social-ugc-gallery__badge-handle">
                            {{ b.handle | default: network_label }}
                          </span>
                        </div>
                      {%- endif -%}
                    {%- endif -%}

                    {%- if s.hover_style == 'overlay' -%}
                      {%- if s.show_captions or has_link -%}
                        <div class="q-social-ugc-gallery__overlay">
                          <div class="q-social-ugc-gallery__overlay-content">
                            {%- if s.show_captions and b.caption != blank -%}
                              <p class="q-social-ugc-gallery__overlay-caption">
                                {{ b.caption }}
                              </p>
                            {%- endif -%}
                            {%- if has_link and b.link_label != blank -%}
                              <span class="q-social-ugc-gallery__overlay-link-label">
                                {{ b.link_label }}
                              </span>
                            {%- endif -%}
                          </div>
                        </div>
                      {%- endif -%}
                    {%- endif -%}
                  </div>

                {%- if has_link -%}
                  </a>
                {%- else -%}
                  </div>
                {%- endif -%}

                {%- if s.hover_style != 'overlay' and s.show_captions and b.caption != blank -%}
                  <p class="q-social-ugc-gallery__caption-below">
                    {{ b.caption }}
                  </p>
                {%- endif -%}
              </li>
            {%- endif -%}
          {%- endif -%}
        {%- endfor -%}
      </ul>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "Social Media - UGC Wall",
  "tag": "section",
  "class": "q-section q-social-ugc-gallery",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "kicker",
      "label": "Kicker",
      "default": "From our community"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "As seen on social"
    },
    {
      "type": "textarea",
      "id": "body",
      "label": "Body",
      "default": "Real photos from customers and creators using our products."
    },
    {
      "type": "select",
      "id": "align",
      "label": "Text alignment",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },

    {
      "type": "header",
      "content": "Grid layout"
    },
    {
      "type": "range",
      "id": "cols_mobile",
      "label": "Columns on mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "default": 2
    },
    {
      "type": "range",
      "id": "cols_tablet",
      "label": "Columns on tablet",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "cols_desktop",
      "label": "Columns on desktop",
      "min": 1,
      "max": 6,
      "step": 1,
      "default": 4
    },
    {
      "type": "select",
      "id": "layout_variant",
      "label": "Layout variant",
      "default": "row",
      "options": [
        { "value": "row", "label": "Row grid" },
        { "value": "stacked", "label": "Stacked (one per row)" }
      ]
    },
    {
      "type": "select",
      "id": "aspect_ratio",
      "label": "Image aspect ratio",
      "default": "square",
      "options": [
        { "value": "square", "label": "Square (1:1)" },
        { "value": "portrait", "label": "Portrait (4:5)" },
        { "value": "landscape", "label": "Landscape (3:2)" },
        { "value": "adapt", "label": "Adapt to image" }
      ]
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Gap between items (px)",
      "min": 4,
      "max": 32,
      "step": 2,
      "default": 12
    },

    {
      "type": "header",
      "content": "Hover & behavior"
    },
    {
      "type": "select",
      "id": "hover_style",
      "label": "Hover style",
      "default": "overlay",
      "options": [
        { "value": "overlay", "label": "Overlay caption" },
        { "value": "lift", "label": "Lift with shadow" },
        { "value": "none", "label": "No hover effect" }
      ]
    },
    {
      "type": "checkbox",
      "id": "show_captions",
      "label": "Show captions",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_social_badge",
      "label": "Show social badge",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "open_in_new_tab",
      "label": "Open links in new tab",
      "default": true
    },

    {
      "type": "header",
      "content": "Background & accessibility"
    },
    {
      "type": "select",
      "id": "bg_scheme",
      "label": "Background scheme",
      "default": "default",
      "options": [
        { "value": "default", "label": "Default" },
        { "value": "subtle", "label": "Subtle surface" },
        { "value": "emphasis", "label": "Emphasis (primary background)" }
      ]
    },
    {
      "type": "text",
      "id": "aria_label",
      "label": "Section aria-label",
      "default": "Social media gallery"
    }
  ],
  "blocks": [
    {
      "type": "ugc_item",
      "name": "UGC item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "select",
          "id": "network",
          "label": "Social network",
          "default": "instagram",
          "options": [
            { "value": "instagram", "label": "Instagram" },
            { "value": "tiktok", "label": "TikTok" },
            { "value": "facebook", "label": "Facebook" },
            { "value": "pinterest", "label": "Pinterest" },
            { "value": "youtube", "label": "YouTube" },
            { "value": "twitter", "label": "Twitter" }
          ]
        },
        {
          "type": "text",
          "id": "handle",
          "label": "Handle",
          "default": "@username"
        },
        {
          "type": "textarea",
          "id": "caption",
          "label": "Caption",
          "default": "Customer photo featuring our product."
        },
        {
          "type": "url",
          "id": "link_url",
          "label": "Post link URL"
        },
        {
          "type": "text",
          "id": "link_label",
          "label": "Link label",
          "default": "View post"
        },
        {
          "type": "text",
          "id": "sr_label",
          "label": "Screen reader label (optional)",
          "default": "View post on social media"
        },
        {
          "type": "checkbox",
          "id": "pin_featured",
          "label": "Feature this item (larger on desktop)",
          "default": false
        }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    {
      "name": "Social Media - UGC Wall",
      "category": "Social Media",
      "blocks": [
        {
          "type": "ugc_item",
          "settings": {
            "network": "instagram",
            "handle": "@customer.one",
            "caption": "Customer photo featuring our product in the wild.",
            "link_url": "https://www.instagram.com/",
            "link_label": "View Instagram post"
          }
        },
        {
          "type": "ugc_item",
          "settings": {
            "network": "tiktok",
            "handle": "@creator.two",
            "caption": "Creator highlight from a recent campaign.",
            "link_url": "https://www.tiktok.com/",
            "link_label": "View TikTok"
          }
        },
        {
          "type": "ugc_item",
          "settings": {
            "network": "facebook",
            "handle": "@customer.three",
            "caption": "Snapshot shared by our community.",
            "link_url": "https://www.facebook.com/",
            "link_label": "View Facebook post"
          }
        }
      ]
    }
  ]
}
{% endschema %}

{% javascript %}{% endjavascript %}
