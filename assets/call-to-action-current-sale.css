/* Quadratum — CTA: Current Sale (scoped)
   - Token aware: uses CSS vars with fallbacks. Theme should define:
     --q-text-base, --q-text-muted, --q-bg-contrast, --q-accent,
     --q-radius, --q-shadow-sm, --q-shadow-md, --q-sale-pill-bg, --q-sale-pill-fg
   - Works with base utilities: .q-section, .container, .btn, .card
*/

.q-cta-sale {
  --cta-text: var(--q-text-base, #111111);
  --cta-muted: var(--q-text-muted, #6b7280);
  --cta-bg-contrast: var(--q-bg-contrast, #f6f7f8);
  --cta-accent: var(--q-accent, #10b981);
  --cta-radius: var(--q-radius, 12px);
  --cta-shadow-sm: var(--q-shadow-sm, 0 1px 2px rgba(0,0,0,.06));
  --cta-shadow-md: var(--q-shadow-md, 0 6px 20px rgba(0,0,0,.10));
  --cta-pad: var(--q-space-md, 1rem);
  --cta-gap: var(--q-space-md, 1rem);
  --cta-gap-lg: var(--q-space-lg, 1.5rem);
  --cta-surface: var(--q-surface, #fff);
  --cta-surface-border: var(--q-surface-border, rgba(17,17,17,.08));
  --cta-surface-accent: var(--q-surface-accent, var(--cta-accent));
  --cta-sale-pill-bg: var(--q-sale-pill-bg, #dc2626);
  --cta-sale-pill-fg: var(--q-sale-pill-fg, #ffffff);
  color: var(--cta-text);
}

/* Surface variants */
.q-cta-sale.q-surface-default .card { background: var(--cta-surface); border: 1px solid var(--cta-surface-border); box-shadow: var(--cta-shadow-sm); }
.q-cta-sale.q-surface-elevated .card { background: var(--cta-surface); border: 1px solid var(--cta-surface-border); box-shadow: var(--cta-shadow-md); }
.q-cta-sale.q-surface-outlined .card { background: var(--cta-surface); border: 2px solid var(--cta-surface-border); box-shadow: none; }
.q-cta-sale.q-surface-accent .card  { background: color-mix(in srgb, var(--cta-surface-accent) 8%, #fff); border: 1px solid color-mix(in srgb, var(--cta-surface-accent) 25%, transparent); }

/* Alignment helper */
.q-cta-sale.q-align-center .cta-row { justify-content: center; }

/* Shared bits */
.q-cta-sale .eyebrow { font-size: .875rem; letter-spacing: .02em; color: var(--cta-muted); margin: 0 0 .25rem; }
.q-cta-sale .headline { font-size: clamp(1.25rem, 1.1rem + 1vw, 1.75rem); line-height: 1.25; margin: 0 0 .5rem; }
.q-cta-sale .subheading { color: var(--cta-muted); margin: 0 0 var(--cta-gap); max-width: 60ch; }

/* Buttons: rely on theme .btn, add minor sizes/secondary */
.q-cta-sale .btn { display: inline-flex; align-items: center; gap: .5rem; }
.q-cta-sale .btn--secondary { background: transparent; border: 1px solid currentColor; }
.q-cta-sale .btn--small { padding: .5rem .75rem; font-size: .875rem; border-radius: calc(var(--cta-radius) - 4px); }

/* Badges / pills */
.q-cta-sale .sale-badge { font-size: .75rem; font-weight: 600; background: var(--cta-accent); color: #fff; padding: .25rem .5rem; border-radius: 9999px; width: max-content; margin-bottom: .75rem; }
.q-cta-sale .discount-pill { display: inline-flex; align-items: center; gap: .5rem; font-size: .8125rem; font-weight: 600; background: var(--cta-sale-pill-bg); color: var(--cta-sale-pill-fg); padding: .35rem .6rem; border-radius: 9999px; }
.q-cta-sale .discount-pill.inline { margin-left: .5rem; }

/* Aspect-ratio helpers (CLS-safe) */
.q-cta-sale .ratio-1-1   { aspect-ratio: 1 / 1; }
.q-cta-sale .ratio-4-3   { aspect-ratio: 4 / 3; }
.q-cta-sale .media-img   { width: 100%; height: 100%; object-fit: cover; display: block; border-radius: calc(var(--cta-radius) - 2px); }
.q-cta-sale .media-overlay { position: absolute; inset: 0; pointer-events: none; border-radius: calc(var(--cta-radius) - 2px); background: linear-gradient(0deg, rgba(0,0,0,.3), rgba(0,0,0,.0)); opacity: var(--cta-media-overlay, .0); }

/* === Variant: Compact Split (base) === */
.q-cta-sale .cta-sale-split { display: grid; grid-template-columns: 1fr; gap: var(--cta-gap-lg); padding: calc(var(--cta-pad) * 1.25); border-radius: var(--cta-radius); }
.q-cta-sale .cta-sale-left { display: grid; gap: .75rem; align-content: start; }
.q-cta-sale .cta-sale-left .media-tile { position: relative; max-width: 320px; }
.q-cta-sale .cta-sale-right { display: grid; gap: .5rem; align-content: start; }
.q-cta-sale .cta-row { display: flex; gap: .75rem; flex-wrap: wrap; margin-top: .25rem; }

@media (min-width: 768px) {
  .q-cta-sale .cta-sale-split { grid-template-columns: auto 1fr; align-items: center; }
}

/* === Variant: Grid Promo Cards === */
.q-cta-sale .grid-head { margin-bottom: .75rem; }
.q-cta-sale .cta-sale-grid { display: grid; gap: var(--cta-gap-lg); padding: calc(var(--cta-pad) * 1.1); border-radius: var(--cta-radius); background: var(--cta-surface, transparent); }
.q-cta-sale .grid-cards { display: grid; gap: var(--cta-gap); grid-template-columns: repeat(2, minmax(0, 1fr)); }
@media (min-width: 768px) { .q-cta-sale .grid-cards { grid-template-columns: repeat(3, minmax(0, 1fr)); } }
@media (min-width: 1024px){ .q-cta-sale .grid-cards { grid-template-columns: repeat(4, minmax(0, 1fr)); } }

.q-cta-sale .promo-card { display: grid; grid-template-rows: auto 1fr; gap: .5rem; text-decoration: none; color: inherit; border-radius: var(--cta-radius); overflow: hidden; background: var(--cta-surface); border: 1px solid var(--cta-surface-border); transition: transform 150ms ease, box-shadow 150ms ease; }
.q-cta-sale .promo-card:where(:hover,:focus-visible){ transform: translateY(-2px); box-shadow: var(--cta-shadow-md); }
.q-cta-sale .promo-media { position: relative; }
.q-cta-sale .promo-media--empty { background: var(--cta-bg-contrast); border-bottom: 1px solid var(--cta-surface-border); }
.q-cta-sale .percent-badge { position: absolute; top: .5rem; left: .5rem; background: rgba(0,0,0,.6); color: #fff; font-size: .8125rem; padding: .25rem .5rem; border-radius: 9999px; }
.q-cta-sale .promo-content { padding: .75rem .9rem 1rem; display: grid; gap: .25rem; }
.q-cta-sale .promo-title { font-size: 1rem; margin: 0; }
.q-cta-sale .promo-sub { color: var(--cta-muted); margin: 0; }

/* === Variant: Urgency Strip === */
.q-cta-sale .cta-sale-strip { display: grid; grid-template-columns: auto 1fr; gap: var(--cta-gap); align-items: center; padding: calc(var(--cta-pad) * .9); border-radius: var(--cta-radius); }
.q-cta-sale .strip-media { width: 72px; position: relative; }
.q-cta-sale .strip-content { display: grid; grid-template-columns: 1fr auto auto; gap: var(--cta-gap); align-items: center; }
.q-cta-sale .strip-copy { display: flex; flex-wrap: wrap; align-items: center; gap: .5rem .75rem; }
.q-cta-sale .strip-urgency { display: flex; align-items: center; gap: .75rem; }
.q-cta-sale .strip-cta { display: flex; justify-content: flex-end; }

@media (max-width: 767.98px){
  .q-cta-sale .cta-sale-strip { grid-template-columns: 1fr; }
  .q-cta-sale .strip-content { grid-template-columns: 1fr; justify-items: start; }
  .q-cta-sale .strip-cta { justify-content: start; }
}

/* Countdown (shared) */
.q-cta-sale .countdown { display: inline-flex; align-items: baseline; gap: .25rem .35rem; font-variant-numeric: tabular-nums; }
.q-cta-sale .countdown .cd-item { font-weight: 700; min-width: 1.5ch; text-align: right; }
.q-cta-sale .countdown--compact .cd-item { min-width: 2ch; }

/* Progress (shared defaults) */
.q-cta-sale .progress-wrap { display: flex; align-items: center; gap: .5rem; }
.q-cta-sale .progressbar { --bar-bg: color-mix(in srgb, var(--cta-accent) 15%, #e5e7eb); --bar-fg: var(--cta-accent); width: 180px; height: 8px; background: var(--bar-bg); border-radius: 9999px; overflow: hidden; }
.q-cta-sale .progressbar--thin { width: 120px; height: 6px; }
.q-cta-sale .progressbar-fill { height: 100%; width: 0%; background: var(--bar-fg); transform-origin: left center; transition: transform 200ms ease, width 200ms ease; }
.q-cta-sale .progress-text { font-size: .8125rem; color: var(--cta-muted); }

/* Tiny motion */
@media (prefers-reduced-motion:no-preference){
  .q-cta-sale .card { animation: qFadeIn .3s ease both; }
  @keyframes qFadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }
}

/* Container modes */
.container-full { width:100%; max-width:none; padding-left: var(--q-space-md,1rem); padding-right: var(--q-space-md,1rem); }

/* Background layer */
.q-cta-sale.q-has-bg { position:relative; }
.q-cta-sale .q-bg { position:absolute; inset:0; overflow:hidden; border-radius: var(--cta-radius,16px); }
.q-cta-sale .q-bg-img { width:100%; height:100%; object-fit:cover; display:block; }
.q-cta-sale .q-bg-overlay { position:absolute; inset:0; background:#000; }

/* Lift content above bg */
.q-cta-sale .container, .q-cta-sale .container-full { position:relative; z-index:1; }

/* Discount pill intrinsic width */
.q-cta-sale .discount-pill { display:inline-flex; width:auto; max-width:max-content; align-self:flex-start; border-radius:9999px; }

/* Decor image */
.q-cta-sale .q-decor { display:block; }
.q-cta-sale .q-decor--top { margin-bottom: var(--cta-gap,12px); }
.q-cta-sale .q-decor--side { margin-top:.5rem; }
.q-cta-sale .q-decor-img { width: var(--decor-w,160px); height:auto; display:block; border-radius: calc(var(--cta-radius,16px) - 6px); box-shadow: var(--cta-shadow-sm, 0 1px 3px rgba(0,0,0,.08)); }

/* Countdown variants */
.q-cta-sale.q-cd-inline .countdown { gap:.25rem; }
.q-cta-sale.q-cd-stacked .countdown .cd-item { background: var(--cta-bg-contrast, #eef1f3); padding:.25rem .35rem; border-radius:8px; }
.q-cta-sale.q-cd-stacked .cd-label { opacity:.75; margin-right:.4rem; }

/* ======================================================
   SPLIT layout polish (scoped, consolidated — no duplicates)
   ====================================================== */
.q-cta-sale [data-layout="split"] .cta-sale-split {
  grid-template-columns: minmax(300px, 520px) 1fr;
  gap: clamp(20px, 3vw, 40px);
  align-items: center;
  padding: clamp(18px, 2.4vw, 28px) clamp(18px, 3vw, 36px);
}

.q-cta-sale [data-layout="split"] .cta-sale-left,
.q-cta-sale [data-layout="split"] .cta-sale-right {
  display: grid;
  align-content: start;
}
.q-cta-sale [data-layout="split"] .cta-sale-right { gap: 12px; }

/* Typography rhythm for split */
.q-cta-sale [data-layout="split"] .g-text .eyebrow {
  font-size: 0.85rem;
  letter-spacing: .04em;
  text-transform: uppercase;
  opacity: .75;
  margin: 0 0 4px 0;
}
.q-cta-sale [data-layout="split"] .g-text .headline { line-height: 1.15; margin: 0 0 8px 0; }
.q-cta-sale [data-layout="split"] .g-text .subheading { color: rgba(0,0,0,.65); margin: 0; max-width: 46ch; }

/* Premium discount pill */
.q-cta-sale [data-layout="split"] .discount-pill {
  padding: 6px 12px;
  border-radius: 999px;
  font-weight: 700;
  font-size: .9rem;
  box-shadow: 0 1px 0 rgba(0,0,0,.05) inset;
}

/* Countdown integrated under copy */
.q-cta-sale [data-layout="split"] .countdown {
  display: inline-flex;
  gap: 6px;
  align-items: center;
  font-weight: 600;
  font-size: .9rem;
  color: rgba(0,0,0,.8);
  margin-top: 2px;
}
.q-cta-sale [data-layout="split"] .countdown .cd-item { min-width: 1.4ch; text-align: right; }
.q-cta-sale [data-layout="split"] .countdown .cd-label { opacity: .6; margin-left: 2px; }

/* Progress: full-width with in-bar label */
.q-cta-sale [data-layout="split"] .progress-wrap { display: block; }
.q-cta-sale [data-layout="split"] .progressbar {
  position: relative;
  width: 100%;
  height: 10px;
  background: rgba(0,0,0,.08);
  border-radius: 999px;
  overflow: hidden;
}
.q-cta-sale [data-layout="split"] .progressbar-fill { height: 100%; border-radius: inherit; }
.q-cta-sale [data-layout="split"] .progress-text {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  font-size: .8rem;
  color: rgba(0,0,0,.7);
  pointer-events: none;
}

/* CTA alignment for split (overrides align-center helper) */
.q-cta-sale [data-layout="split"] .cta-row {
  margin-top: 6px;
  gap: 10px;
  justify-content: flex-start;
}
.q-cta-sale [data-layout="split"] .cta-row .btn {
  border-radius: 999px;
  padding: 11px 20px;
  font-weight: 700;
  transform: translateZ(0);
}
.q-cta-sale [data-layout="split"] .cta-row .btn:hover { filter: brightness(0.96); }

/* Card elevation & media niceties for split */
.q-cta-sale [data-layout="split"] .card {
  border-radius: 16px;
  box-shadow:
    0 1px 2px rgba(0,0,0,.05),
    0 10px 28px rgba(0,0,0,.06);
}
.q-cta-sale [data-layout="split"] .media-tile { border-radius: 12px; overflow: hidden; }

/* If no left content, don't reserve space */
.q-cta-sale [data-layout="split"] .cta-sale-left:empty { display: none; }

/* Responsive collapse for split */
@media (max-width: 900px) {
  .q-cta-sale [data-layout="split"] .cta-sale-split { grid-template-columns: 1fr; gap: 20px; }
  .q-cta-sale [data-layout="split"] .cta-row { justify-content: flex-start; }
}

/* === Split visual hot-fix === */
.q-cta-sale [data-layout="split"] .cta-sale-right {
  max-width: 560px; /* keeps content tight so it doesn't feel empty */
}

.q-cta-sale [data-layout="split"] .progress-wrap {
  position: relative;
  display: block;
  margin-top: 4px;
}

.q-cta-sale [data-layout="split"] .progressbar {
  width: clamp(220px, 36vw, 420px);  /* stop the runway bar */
  height: 10px;
}

.q-cta-sale [data-layout="split"] .progress-text {
  position: absolute;               /* put % INSIDE the bar */
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  font-size: .8rem;
  color: rgba(255,255,255,.9);
  mix-blend-mode: normal;
}

/* If a countdown is placed in the LEFT column, hide it on desktop.
   (Use Slot=right if you want it; this just prevents the orphaned timer.) */
@media (min-width: 901px){
  .q-cta-sale [data-layout="split"] .cta-sale-left .countdown { display: none; }
}

/* Nicer breathing room between progress and CTA */
.q-cta-sale [data-layout="split"] .cta-row { margin-top: 10px; }
  
/* SPLIT — restore visible % label */
.q-cta-sale [data-layout="split"] .progress-wrap { display: flex; align-items: center; gap: 8px; }

.q-cta-sale [data-layout="split"] .progressbar {
  width: clamp(220px, 36vw, 420px);
  height: 10px;
  border-radius: 999px;
  position: relative;
}

.q-cta-sale [data-layout="split"] .progress-text {
  position: static;              /* not absolutely positioned */
  transform: none;
  color: var(--cta-muted);
  font-size: .85rem;
  line-height: 1;
}

/* SPLIT — subtle tinted wash on elevated */
.q-cta-sale.q-surface-elevated [data-layout="split"] .card {
  background: color-mix(in srgb, var(--cta-surface-accent, var(--cta-accent)) 6%, #fff);
  border: 1px solid color-mix(in srgb, var(--cta-surface-accent, var(--cta-accent)) 18%, transparent);
}

/* SPLIT — keep the right column compact for balance */
.q-cta-sale [data-layout="split"] .cta-sale-right { max-width: 560px; }

/* === Hotfix: keep Split image tidy and restore Strip flex feel === */

/* 1) SPLIT — cap the left media and prevent column stretch */
.q-cta-sale [data-layout="split"] .cta-sale-split{
  grid-template-columns: minmax(220px, max-content) 1fr; /* left sizes to content, not full width */
}

.q-cta-sale [data-layout="split"] .cta-sale-left .media-tile{
  /* Respect block setting via --media-w, but keep a sane clamp */
  width: clamp(200px, 28vw, var(--media-w, 320px));
  max-width: 360px;
  justify-self: start;  /* don't center/expand */
}

/* 2) STRIP — bring back the horizontal "flex" vibe on desktop */
@media (min-width: 768px){
  .q-cta-sale [data-layout="strip"] .strip-content{
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--cta-gap);
  }
  .q-cta-sale [data-layout="strip"] .strip-copy{
    flex: 1 1 auto;
    min-width: 240px;
  }
  .q-cta-sale [data-layout="strip"] .strip-urgency-cta{
    display: flex;
    align-items: center;
    gap: var(--cta-gap);
  }
}

/* Optional: keep Split right column from running too wide so things feel balanced */
.q-cta-sale [data-layout="split"] .cta-sale-right{
  max-width: 560px;
}

/* === Split: lock left image size, keep right column tidy === */
.q-cta-sale [data-layout="split"] .cta-sale-split{
  grid-template-columns: minmax(220px, max-content) 1fr;
}

.q-cta-sale [data-layout="split"] .cta-sale-left .media-tile{
  /* width flows with viewport but never exceeds your block Width or our cap */
  width: clamp(200px, 28vw, 360px);
  max-width: min(360px, var(--media-w, 320px));
  justify-self: start;
}

.q-cta-sale [data-layout="split"] .cta-sale-right{
  max-width: 560px; /* keeps copy/CTA from running too wide */
}

/* === Strip: restore the skinny FLEX banner feel on desktop === */
@media (min-width: 768px){
  .q-cta-sale [data-layout="strip"] .strip-content{
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--cta-gap);
  }
  .q-cta-sale [data-layout="strip"] .strip-copy{ flex: 1 1 auto; min-width: 240px; }
  .q-cta-sale [data-layout="strip"] .strip-urgency-cta{ display: flex; align-items: center; gap: var(--cta-gap); }
}

/* Center the grid header text + constrain nicely */
.q-cta-sale [data-layout="grid"] .grid-head .g-text { text-align: center; }
.q-cta-sale [data-layout="grid"] .grid-head .g-text .subheading { 
  margin-left: auto; 
  margin-right: auto; 
  max-width: 60ch;  /* keep your readable line length */
}
/* If you show the discount pill in the header, center it too */
.q-cta-sale [data-layout="grid"] .grid-head .discount-pill { 
  margin-inline: auto; 
}

/* Center the grid header + tiles (GRID layout only) */
.q-cta-sale [data-layout="grid"] .grid-head,
.q-cta-sale [data-layout="grid"] .grid-cards{
  max-width: 1200px;          /* contain the grid */
  margin-inline: auto;        /* center the block within the page */
}

/* Make cards a sensible width and center remaining columns */
.q-cta-sale [data-layout="grid"] .grid-cards{
  grid-template-columns: repeat(auto-fit, minmax(240px, 280px));
  justify-content: center;    /* center the tracks */
  justify-items: stretch;     /* cards fill their track */
  gap: var(--cta-gap);
}

/* If you prefer wider cards on big screens, bump at XL */
@media (min-width: 1200px){
  .q-cta-sale [data-layout="grid"] .grid-cards{
    grid-template-columns: repeat(auto-fit, minmax(260px, 320px));
  }
}
