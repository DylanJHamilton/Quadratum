{% comment %}
  Quadratum — Snippet: Blog Card
  File: snippets/blog-card.liquid

  Contract:
  {% render 'blog-card',
    article: article,
    heading_level: 3,
    show_image: true/false,
    show_author: true/false,
    show_date: true/false,
    show_read_time: true/false,
    show_tags: true/false,
    show_excerpt: true/false,
    excerpt_text: '...',
    cta_label: 'Read more'
  %}

  Notes:
  • Neutral base styling; layouts (list/grid/masonry) are controlled by the parent feed section.
  • Avoid “pill card” look by default.
{% endcomment %}

{%- liquid
  assign a = article
  if a == blank
    break
  endif

  assign heading_level = heading_level | default: 3
  assign cta_label = cta_label | default: 'Read more'

  assign show_image = show_image
  assign show_author = show_author
  assign show_date = show_date
  assign show_read_time = show_read_time
  assign show_tags = show_tags
  assign show_excerpt = show_excerpt

  assign excerpt_text = excerpt_text | default: ''

  assign minutes = 0
  if show_read_time
    assign wc = a.content | strip_html | strip | split: ' ' | size
    assign minutes = wc | divided_by: 200
    if minutes < 1
      assign minutes = 1
    endif
  endif

  assign img = a.image
-%}

<article class="q-blogcard">
  {%- if show_image and img != blank -%}
    <a class="q-blogcard__media" href="{{ a.url }}" aria-label="{{ a.title | escape }}">
      {{ img | image_url: width: 1200 | image_tag:
        loading: 'lazy',
        widths: '240, 360, 540, 720, 900, 1200',
        sizes: '(min-width: 990px) 33vw, (min-width: 750px) 50vw, 100vw',
        class: 'q-blogcard__img'
      }}
    </a>
  {%- endif -%}

  <div class="q-blogcard__body">
    {%- if show_tags and a.tags != blank -%}
      <div class="q-blogcard__tags" aria-label="Tags">
        {%- for t in a.tags limit: 3 -%}
          <span class="q-blogcard__tag">{{ t }}</span>
        {%- endfor -%}
      </div>
    {%- endif -%}

    {%- case heading_level -%}
      {%- when 1 -%}<h1 class="q-blogcard__title"><a href="{{ a.url }}">{{ a.title }}</a></h1>
      {%- when 2 -%}<h2 class="q-blogcard__title"><a href="{{ a.url }}">{{ a.title }}</a></h2>
      {%- when 3 -%}<h3 class="q-blogcard__title"><a href="{{ a.url }}">{{ a.title }}</a></h3>
      {%- when 4 -%}<h4 class="q-blogcard__title"><a href="{{ a.url }}">{{ a.title }}</a></h4>
      {%- when 5 -%}<h5 class="q-blogcard__title"><a href="{{ a.url }}">{{ a.title }}</a></h5>
      {%- else -%}<h6 class="q-blogcard__title"><a href="{{ a.url }}">{{ a.title }}</a></h6>
    {%- endcase -%}

    {%- if show_author or show_date or show_read_time -%}
      <div class="q-blogcard__meta">
        {%- if show_date -%}
          <time datetime="{{ a.published_at | date: '%Y-%m-%d' }}">{{ a.published_at | date: format: 'abbreviated_date' }}</time>
        {%- endif -%}
        {%- if show_author and a.author != blank -%}
          <span class="q-blogcard__sep" aria-hidden="true">•</span>
          <span>{{ a.author }}</span>
        {%- endif -%}
        {%- if show_read_time -%}
          <span class="q-blogcard__sep" aria-hidden="true">•</span>
          <span>{{ minutes }} min read</span>
        {%- endif -%}
      </div>
    {%- endif -%}

    {%- if show_excerpt -%}
      {%- assign ex = excerpt_text -%}
      {%- if ex == blank -%}
        {%- assign ex = a.excerpt_or_content | strip_html | strip | truncatewords: 24, '…' -%}
      {%- endif -%}
      {%- if ex != blank -%}
        <div class="q-blogcard__excerpt rte">{{ ex }}</div>
      {%- endif -%}
    {%- endif -%}

    <div class="q-blogcard__cta">
      <a class="q-blogcard__link" href="{{ a.url }}">
        {{ cta_label }}
      </a>
    </div>
  </div>

  <style>
    /* Neutral base: layout-specific polish comes from Feed section */
    .q-blogcard{
      border: 1px solid var(--q-border, rgba(0,0,0,.12));
      border-radius: var(--q-radius-md, 16px);
      overflow: hidden;
      background: var(--q-surface, #fff);
    }
    .q-blogcard__media{ display:block; }
    .q-blogcard__img{ display:block; width:100%; height:auto; }

    .q-blogcard__body{
      padding: var(--q-gap-md, 16px);
      display:flex;
      flex-direction:column;
      gap: var(--q-gap-sm, 10px);
    }

    .q-blogcard__tags{ display:flex; flex-wrap:wrap; gap: .4rem; }
    .q-blogcard__tag{
      font-size: var(--q-fs-xs, .8rem);
      padding: .2em .55em;
      border-radius: var(--q-radius-pill, 999px);
      border: 1px solid var(--q-border, rgba(0,0,0,.12));
      opacity: .9;
    }

    .q-blogcard__title{ margin:0; font-size: var(--q-fs-lg, 1.1rem); line-height: 1.2; }
    .q-blogcard__title a{ text-decoration:none; color: inherit; }

    .q-blogcard__meta{
      display:flex;
      flex-wrap:wrap;
      gap:.4rem;
      align-items:center;
      font-size: var(--q-fs-sm, .92rem);
      opacity:.85;
    }
    .q-blogcard__sep{ opacity:.6; }

    .q-blogcard__excerpt{ font-size: var(--q-fs-base, 1rem); opacity:.92; }

    .q-blogcard__cta{ margin-top: var(--q-gap-xs, 8px); }
    .q-blogcard__link{
      text-decoration:none;
      font-size: var(--q-fs-sm, .92rem);
      display:inline-flex;
      align-items:center;
      gap: .35rem;
    }
    .q-blogcard__link:after{
      content: "→";
      opacity: .8;
    }
  </style>
</article>
