{%- comment -%}
  snippets/q-social-pinterest-card.liquid
  Quadratum â€” Pinterest pin card (manual)
{%- endcomment -%}

{%- liquid
  assign b = block.settings
  assign s = section_settings

  assign card_style = s.card_style | default: 'surface'
  assign ratio = s.image_ratio | default: '2:3'
  assign url = b.pinterest_url
  assign has_url = false

  if url != blank and url != '#'
    assign has_url = true
  endif

  assign ratio_key = ratio
  if ratio_key == 'adapt' and b.image == blank
    assign ratio_key = '2:3'
  endif

  assign ratio_class = ''
  if ratio_key != 'adapt'
    assign ratio_class = 'q-media--ratio-' | append: ratio_key | replace: ':', '-'
  endif

  assign alt_text = b.title | default: 'Pinterest pin image' | escape
-%}

<article
  class="q-pin-card q-pin-card--{{ card_style }}"
  {{ block.shopify_attributes }}
>
  {%- if has_url -%}
    <a
      href="{{ url }}"
      class="q-pin-card__link"
      aria-label="{{ b.aria_label | default: 'View this idea on Pinterest' | escape }}"
      {%- if s.open_in_new_tab -%} target="_blank" rel="noopener noreferrer"{%- endif -%}
    >
  {%- endif -%}

    <div class="q-pin-card__media q-media{% if ratio == 'adapt' and b.image != blank %} q-media--adapt{% endif %}{% if ratio_class != blank %} {{ ratio_class }}{% endif %}">
      {%- if b.image != blank -%}
        {{ b.image | image_url: width: 960 | image_tag: loading: 'lazy', alt: alt_text }}
      {%- else -%}
        <div class="q-pin-card__media-placeholder" aria-hidden="true"></div>
      {%- endif -%}

      {%- if s.show_pinterest_badge -%}
        <div class="q-pin-card__platform-badge" aria-hidden="true">
          {%- render 'icon-social', name: 'pinterest' -%}
        </div>
      {%- endif -%}
    </div>

    <div class="q-pin-card__body">
      {%- if s.show_title and b.title != blank -%}
        <h3 class="q-pin-card__title">
          {{ b.title | escape }}
        </h3>
      {%- endif -%}

      {%- if s.show_copy and b.copy != blank -%}
        <p class="q-pin-card__copy">
          {{ b.copy | escape | newline_to_br }}
        </p>
      {%- endif -%}

      {%- if s.show_view_label and has_url -%}
        <span class="q-pin-card__view-label">
          View on Pinterest
        </span>
      {%- endif -%}
    </div>

  {%- if has_url -%}
    </a>
  {%- endif -%}
</article>


<style>
    .q-pin-card__platform-badge {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 34px;
  height: 34px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  background: rgba(0,0,0,.65);
  color: #fff;
  z-index: 2;
}

.q-pin-card__platform-badge-mark {
  font-weight: 700;
  line-height: 1;
}

.q-pin-card__media {
  position: relative;
  overflow: hidden;
}

.q-pin-card__media-placeholder {
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.06);
}
.q-pin-card__platform-badge svg {
  width: 100%;
  height: 100%;
  display: block;
}

</style>