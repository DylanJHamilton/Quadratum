{% comment %}
  Quadratum â€” Shared Map Locator Engine
  File: snippets/map-locator-engine.liquid

  Purpose:
  - Converts section DOM into a single locator instance for JS
  - Loads Google Maps JS API once per page (via maps-locator.js)
  - Reusable by Store Locator + Simple Contact Map + future sections

  Inputs:
    section_id (required)
    map_enabled (boolean)
    center_lat (string/number)
    center_lng (string/number)
    zoom_level (number)
{% endcomment %}

{%- assign sid = section_id -%}

<script type="application/json" id="QMapLocatorData-{{ sid }}">
{
  "sectionId": "{{ sid }}",
  "mapEnabled": {% if map_enabled %}true{% else %}false{% endif %},
  "center": { "lat": "{{ center_lat }}", "lng": "{{ center_lng }}" },
  "zoom": {{ zoom_level | plus: 0 }},
  "google": {
    "enabled": {% if settings.gmap_enable and settings.gmap_api_key != blank %}true{% else %}false{% endif %},
    "apiKey": "{{ settings.gmap_api_key | escape }}"
  }
}
</script>

<script>
  window.QuadratumMapLocators = window.QuadratumMapLocators || [];
  window.QuadratumMapLocators.push("{{ sid }}");
</script>
