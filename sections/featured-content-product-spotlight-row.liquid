{% comment %}
  Quadratum — Featured · Product Spotlight Row
  File: sections/featured-content-product-spotlight-row.liquid

  Default behavior (Pages-friendly):
  - Manual products (if set)
  - Chosen collection (if set + has products)
  - Latest products from collections['all'] (newest first)
  - Latest products from collections['frontpage'] (newest first)
  - Placeholders (so layout is always testable)
{% endcomment %}

{%- liquid
  assign sid = section.id

  assign source_mode = section.settings.source_mode | default: 'manual'
  assign max_items = section.settings.max_items | default: 8
  assign layout_variant = section.settings.layout_variant | default: 'hero_row'
  assign supporting_mode = section.settings.supporting_mode | default: 'carousel'

  assign show_header = section.settings.show_header
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
  assign view_all_label = section.settings.view_all_label | default: 'View all'
  assign view_all_url = section.settings.view_all_url

  assign hero_index = section.settings.hero_index | default: 1
  assign hero_index0 = hero_index | minus: 1

  assign card_preset = section.settings.card_preset | default: 'catalog'
  assign density = section.settings.card_density | default: 'compact'

  assign media_mode = section.settings.media_mode | default: 'single'
  assign media_fit = section.settings.media_fit | default: 'cover'
  assign image_zoom = section.settings.image_zoom
  assign hover_treatment = section.settings.hover_treatment | default: 'overlay_actions'
  assign hover_overlay_opacity = section.settings.hover_overlay_opacity | default: 15
  assign hover_actions_visibility = section.settings.hover_actions_visibility | default: 'desktop_only'
  assign actions_layout = section.settings.actions_layout | default: 'stack'

  assign enable_quick_add = section.settings.enable_quick_add
  assign enable_quick_view = section.settings.enable_quick_view
  assign quick_add_mode = section.settings.quick_add_mode | default: 'sizes'
  assign quick_view_mode = section.settings.quick_view_mode | default: 'drawer'
  assign quick_view_placement = section.settings.quick_view_placement | default: 'overlay'

  assign show_action_row = section.settings.show_action_row
  assign show_secondary_row_cta = section.settings.show_secondary_row_cta
  assign show_row_quick_view = section.settings.show_row_quick_view

  assign label_add_to_bag = section.settings.label_add_to_bag | default: 'Add to bag'
  assign label_learn_more = section.settings.label_learn_more | default: 'Learn more'
  assign label_quick_view = section.settings.label_quick_view | default: 'Quick view'
  assign label_select_options = section.settings.label_select_options | default: 'Select options'
  assign label_sold_out = section.settings.label_sold_out | default: 'Sold out'

  assign title_size = section.settings.title_size | default: 16
  assign title_weight = section.settings.title_weight | default: '600'
  assign price_size = section.settings.price_size | default: 15
  assign price_weight = section.settings.price_weight | default: '600'
  assign title_style = section.settings.title_style | default: 'inherit'

  assign show_badges = section.settings.show_badges
  assign badge_sale = section.settings.badge_sale

  assign section_bg = section.settings.section_bg
  assign section_border = section.settings.section_border
  assign section_radius = section.settings.section_radius | default: 0
  assign pad_y = section.settings.pad_y | default: 0
  assign pad_x = section.settings.pad_x | default: 0

  assign hero_ratio = section.settings.hero_media_ratio | default: 105
  assign support_ratio = section.settings.support_media_ratio | default: 105

  assign hero_max_h = section.settings.hero_max_h | default: 70

  comment
    Background media
  endcomment
  assign bg_mode = section.settings.bg_mode | default: 'none'
  assign bg_image = section.settings.bg_image
  assign bg_video = section.settings.bg_video
  assign bg_fit = section.settings.bg_fit | default: 'cover'
  assign bg_position = section.settings.bg_position | default: 'center center'
  assign bg_overlay_color = section.settings.bg_overlay_color
  assign bg_overlay_opacity = section.settings.bg_overlay_opacity | default: 25
  assign bg_blur = section.settings.bg_blur | default: 0
  assign bg_dim = section.settings.bg_dim | default: 0

  assign density_class = 'q-density--compact'
  if density == 'comfortable'
    assign density_class = 'q-density--comfortable'
  endif

  assign style_vars = ''
  assign style_vars = style_vars | append: '--q-section-bg:' | append: section_bg | append: ';'
  assign style_vars = style_vars | append: '--q-section-border:' | append: section_border | append: ';'
  assign style_vars = style_vars | append: '--q-section-radius:' | append: section_radius | append: 'px;'
  assign style_vars = style_vars | append: '--q-pad-y:' | append: pad_y | append: 'px;'
  assign style_vars = style_vars | append: '--q-pad-x:' | append: pad_x | append: 'px;'
  assign style_vars = style_vars | append: '--q-hero-ratio:' | append: hero_ratio | append: '%;'
  assign style_vars = style_vars | append: '--q-support-ratio:' | append: support_ratio | append: '%;'
  assign style_vars = style_vars | append: '--q-hover-overlay:' | append: hover_overlay_opacity | append: '%;'
  assign style_vars = style_vars | append: '--q-hero-max-h:' | append: hero_max_h | append: 'vh;'
  assign style_vars = style_vars | append: '--q-bg-overlay:' | append: bg_overlay_opacity | append: '%;'
  assign style_vars = style_vars | append: '--q-bg-blur:' | append: bg_blur | append: 'px;'
  assign style_vars = style_vars | append: '--q-bg-dim:' | append: bg_dim | append: '%;'
  assign style_vars = style_vars | append: '--q-bg-position:' | append: bg_position | append: ';'

  if title_style == 'coquette'
    assign style_vars = style_vars | append: '--q-card-title-ff: var(--q-font-accent, var(--q-font-heading, inherit));'
    assign style_vars = style_vars | append: '--q-card-title-ls: .02em;'
  else
    assign style_vars = style_vars | append: '--q-card-title-ff: inherit;'
    assign style_vars = style_vars | append: '--q-card-title-ls: normal;'
  endif

  assign items = blank
  assign using_placeholders = false

  assign manual_products = section.settings.products
  assign manual_count = 0
  if manual_products != blank
    assign manual_count = manual_products.size
  endif

  assign feed_collection = blank
  if section.settings.collection != blank
    assign feed_handle = section.settings.collection.handle | default: section.settings.collection
    if feed_handle != blank
      assign feed_collection = collections[feed_handle]
    endif
  endif

  if source_mode == 'manual' and manual_count > 0
    assign items = manual_products
  elsif source_mode == 'collection' and feed_collection != blank and feed_collection.products_count > 0
    assign items = feed_collection.products
  else
    assign all_col = collections['all']
    assign front_col = collections['frontpage']

    if all_col != blank and all_col.products_count > 0
      assign items = all_col.products | sort: 'published_at' | reverse
    elsif front_col != blank and front_col.products_count > 0
      assign items = front_col.products | sort: 'published_at' | reverse
    else
      assign items = blank
      assign using_placeholders = true
    endif
  endif

  assign items_limited = items | slice: 0, max_items

  assign hero = blank
  if items_limited != blank and items_limited.size > 0
    if hero_index0 < items_limited.size
      assign hero = items_limited[hero_index0]
    else
      assign hero = items_limited[0]
    endif
  endif

  assign placeholder_count = max_items
  if placeholder_count < 3
    assign placeholder_count = 3
  endif

  assign has_bg = false
  if bg_mode == 'image' and bg_image != blank
    assign has_bg = true
  elsif bg_mode == 'video' and bg_video != blank
    assign has_bg = true
  endif
-%}

<section
  class="q-spotlight {{ density_class }}{% if has_bg %} q-spotlight--has-bg{% endif %}"
  data-section-id="{{ sid }}"
  data-spotlight
  data-variant="{{ layout_variant }}"
  data-supporting="{{ supporting_mode }}"
  style="{{ style_vars }}"
>
  {%- if has_bg -%}
    <div class="q-spotlight__bg" aria-hidden="true">
      {%- if bg_mode == 'image' and bg_image != blank -%}
        {%- assign bg_src = bg_image | image_url: width: 2400 -%}
        <img
          class="q-spotlight__bg-media"
          src="{{ bg_src }}"
          alt=""
          loading="lazy"
          width="{{ bg_image.width }}"
          height="{{ bg_image.height }}"
          style="object-fit: {{ bg_fit }};"
        >
      {%- elsif bg_mode == 'video' and bg_video != blank -%}
        <div class="q-spotlight__bg-media q-spotlight__bg-video" style="object-fit: {{ bg_fit }};">
          {{ bg_video | video_tag: autoplay: true, loop: true, muted: true, controls: false, playsinline: true, preload: 'metadata' }}
        </div>
      {%- endif -%}

      <div class="q-spotlight__bg-dim"></div>
      <div class="q-spotlight__bg-overlay"{% if bg_overlay_color != blank %} style="background: {{ bg_overlay_color }};"{% endif %}></div>
    </div>
  {%- endif -%}

  <div class="q-spotlight__inner">
    {%- if show_header -%}
      <header class="q-spotlight__header">
        <div class="q-spotlight__head-left">
          {%- if heading != blank -%}<h2 class="q-spotlight__heading">{{ heading }}</h2>{%- endif -%}
          {%- if subheading != blank -%}<div class="q-spotlight__subheading">{{ subheading }}</div>{%- endif -%}
        </div>
        <div class="q-spotlight__head-right">
          {%- if view_all_url != blank -%}
            <a class="q-spotlight__viewall" href="{{ view_all_url }}">{{ view_all_label }}</a>
          {%- endif -%}
        </div>
      </header>
    {%- endif -%}

    {%- if using_placeholders -%}
      <div class="q-spotlight__empty" role="status">
        <strong>No products available from “all” or “frontpage”.</strong>
        <div>Rendering placeholders so you can test layout on Pages.</div>
      </div>

      {%- if layout_variant == 'grid' -%}
        <div class="q-spotlight__grid">
          {%- for i in (1..placeholder_count) -%}
            <div class="q-spotlight__cell">
              <div class="q-ph-card">
                <div class="q-ph-media"></div>
                <div class="q-ph-body">
                  <div class="q-ph-title">Placeholder item {{ i }}</div>
                  <div class="q-ph-price">$0.00</div>
                </div>
              </div>
            </div>
          {%- endfor -%}
        </div>
      {%- else -%}
        <div class="q-spotlight__layout">
          <div class="q-spotlight__hero">
            <div class="q-ph-card q-ph-card--hero">
              <div class="q-ph-media q-ph-media--hero"></div>
              <div class="q-ph-body">
                <div class="q-ph-title">Hero placeholder</div>
                <div class="q-ph-price">$0.00</div>
              </div>
            </div>
          </div>

          <div class="q-spotlight__support">
            <div class="q-spotlight__support-inner" data-supporting-wrap>
              {%- for i in (1..placeholder_count) -%}
                <div class="q-spotlight__support-item" data-supporting-item>
                  <div class="q-ph-card">
                    <div class="q-ph-media"></div>
                    <div class="q-ph-body">
                      <div class="q-ph-title">Placeholder item {{ i }}</div>
                      <div class="q-ph-price">$0.00</div>
                    </div>
                  </div>
                </div>
              {%- endfor -%}
            </div>

            {%- if supporting_mode == 'carousel' -%}
              <div class="q-spotlight__support-nav" aria-label="Carousel controls">
                <button type="button" class="q-spotlight__btn" data-prev aria-label="Previous">Prev</button>
                <button type="button" class="q-spotlight__btn" data-next aria-label="Next">Next</button>
              </div>
            {%- endif -%}
          </div>
        </div>
      {%- endif -%}

    {%- elsif hero == blank -%}
      <div class="q-spotlight__empty" role="status">
        <strong>No products found.</strong>
        <div>Choose manual products or a collection, or ensure “all/frontpage” has products available.</div>
      </div>

    {%- else -%}

      {%- if layout_variant == 'grid' -%}
        <div class="q-spotlight__grid">
          {%- for product in items_limited -%}
            <div class="q-spotlight__cell">
              {%- render 'product-card',
                product: product,
                card_preset: card_preset,
                media_mode: media_mode,
                media_fit: media_fit,
                media_ratio: support_ratio,
                image_zoom: image_zoom,
                hover_treatment: hover_treatment,
                hover_overlay_opacity: hover_overlay_opacity,
                hover_actions_visibility: hover_actions_visibility,
                actions_layout: actions_layout,
                enable_quick_add: enable_quick_add,
                enable_quick_view: enable_quick_view,
                quick_add_mode: quick_add_mode,
                quick_view_mode: quick_view_mode,
                quick_view_placement: quick_view_placement,
                show_badges: show_badges,
                badge_sale: badge_sale,
                title_size: title_size,
                title_weight: title_weight,
                price_size: price_size,
                price_weight: price_weight,
                label_select_options: label_select_options,
                label_sold_out: label_sold_out,
                show_action_row: show_action_row,
                show_secondary_row_cta: show_secondary_row_cta,
                show_row_quick_view: show_row_quick_view,
                primary_cta_label: label_add_to_bag,
                secondary_cta_label: label_learn_more,
                qv_label: label_quick_view
              -%}
            </div>
          {%- endfor -%}
        </div>

      {%- else -%}
        <div class="q-spotlight__layout">
          <div class="q-spotlight__hero">
            {%- render 'product-card',
              product: hero,
              card_preset: card_preset,
              media_mode: media_mode,
              media_fit: media_fit,
              media_ratio: hero_ratio,
              image_zoom: image_zoom,
              hover_treatment: hover_treatment,
              hover_overlay_opacity: hover_overlay_opacity,
              hover_actions_visibility: hover_actions_visibility,
              actions_layout: actions_layout,
              enable_quick_add: enable_quick_add,
              enable_quick_view: enable_quick_view,
              quick_add_mode: quick_add_mode,
              quick_view_mode: quick_view_mode,
              quick_view_placement: quick_view_placement,
              show_badges: show_badges,
              badge_sale: badge_sale,
              title_size: title_size,
              title_weight: title_weight,
              price_size: price_size,
              price_weight: price_weight,
              label_select_options: label_select_options,
              label_sold_out: label_sold_out,
              show_action_row: show_action_row,
              show_secondary_row_cta: show_secondary_row_cta,
              show_row_quick_view: show_row_quick_view,
              primary_cta_label: label_add_to_bag,
              secondary_cta_label: label_learn_more,
              qv_label: label_quick_view
            -%}
          </div>

          <div class="q-spotlight__support">
            <div class="q-spotlight__support-inner" data-supporting-wrap>
              {%- for product in items_limited -%}
                {%- if product.id == hero.id -%}{%- continue -%}{%- endif -%}
                <div class="q-spotlight__support-item" data-supporting-item>
                  {%- render 'product-card',
                    product: product,
                    card_preset: card_preset,
                    media_mode: media_mode,
                    media_fit: media_fit,
                    media_ratio: support_ratio,
                    image_zoom: image_zoom,
                    hover_treatment: hover_treatment,
                    hover_overlay_opacity: hover_overlay_opacity,
                    hover_actions_visibility: hover_actions_visibility,
                    actions_layout: actions_layout,
                    enable_quick_add: enable_quick_add,
                    enable_quick_view: enable_quick_view,
                    quick_add_mode: quick_add_mode,
                    quick_view_mode: quick_view_mode,
                    quick_view_placement: quick_view_placement,
                    show_badges: show_badges,
                    badge_sale: badge_sale,
                    title_size: title_size,
                    title_weight: title_weight,
                    price_size: price_size,
                    price_weight: price_weight,
                    label_select_options: label_select_options,
                    label_sold_out: label_sold_out,
                    show_action_row: show_action_row,
                    show_secondary_row_cta: show_secondary_row_cta,
                    show_row_quick_view: show_row_quick_view,
                    primary_cta_label: label_add_to_bag,
                    secondary_cta_label: label_learn_more,
                    qv_label: label_quick_view
                  -%}
                </div>
              {%- endfor -%}
            </div>

            {%- if supporting_mode == 'carousel' -%}
              <div class="q-spotlight__support-nav" aria-label="Carousel controls">
                <button type="button" class="q-spotlight__btn" data-prev aria-label="Previous">Prev</button>
                <button type="button" class="q-spotlight__btn" data-next aria-label="Next">Next</button>
              </div>
            {%- endif -%}
          </div>
        </div>
      {%- endif -%}
    {%- endif -%}
  </div>

  <style>
    [data-section-id="{{ sid }}"]{
      position: relative;
      background: var(--q-section-bg, transparent);
      border: 1px solid var(--q-section-border, transparent);
      border-radius: var(--q-section-radius, 0px);
      overflow: hidden; /* so bg respects radius */
    }
    [data-section-id="{{ sid }}"] .q-spotlight__inner{
      position: relative;
      z-index: 2;
      padding-block: var(--q-pad-y, 0px);
      padding-inline: var(--q-pad-x, 0px);
    }

    /* Background media */
    [data-section-id="{{ sid }}"] .q-spotlight__bg{
      position:absolute;
      inset:0;
      z-index:0;
      pointer-events:none;
    }
    [data-section-id="{{ sid }}"] .q-spotlight__bg-media{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-position: var(--q-bg-position, center center);
      filter: blur(var(--q-bg-blur, 0px));
      transform: translateZ(0);
    }
    [data-section-id="{{ sid }}"] .q-spotlight__bg-video video{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: cover; /* fit comes from wrapper; video_tag uses <video> */
      object-position: var(--q-bg-position, center center);
    }
    [data-section-id="{{ sid }}"] .q-spotlight__bg-dim{
      position:absolute;
      inset:0;
      background: rgba(0,0,0, calc(var(--q-bg-dim, 0%) / 100));
    }
    [data-section-id="{{ sid }}"] .q-spotlight__bg-overlay{
      position:absolute;
      inset:0;
      opacity: calc(var(--q-bg-overlay, 25%) / 100);
      background: rgba(255,255,255,0.0); /* overridden by inline style when set */
      mix-blend-mode: normal;
    }

    .q-spotlight__header{ display:flex; align-items:flex-end; justify-content:space-between; gap: var(--q-gap, 1rem); margin-bottom: var(--q-gap, 1rem); }
    .q-spotlight__heading{ margin:0; font-size: var(--q-h2-fs, 1.5rem); line-height: 1.15; }
    .q-spotlight__subheading{ margin-top:.25rem; opacity:.85; max-width: 70ch; }
    .q-spotlight__viewall{ display:inline-flex; align-items:center; justify-content:center; border:1px solid var(--q-border, currentColor); border-radius: 999px; padding:.6rem .9rem; text-decoration:none; }

    .q-spotlight__empty{ border:1px dashed var(--q-border, rgba(0,0,0,.2)); border-radius: 14px; padding: 1.25rem; opacity: .9; margin-bottom: var(--q-gap, 1rem); backdrop-filter: blur(6px); }

    .q-spotlight__grid{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: var(--q-gap, 1rem); }
    @media (min-width: 750px){ .q-spotlight__grid{ grid-template-columns: repeat(3, minmax(0,1fr)); } }
    @media (min-width: 990px){ .q-spotlight__grid{ grid-template-columns: repeat(4, minmax(0,1fr)); } }

    .q-spotlight__layout{ display:grid; gap: var(--q-gap, 1rem); align-items:start; }
    .q-spotlight__hero{ min-width: 0; }
    .q-spotlight__support{ min-width: 0; }
    @media (min-width: 990px){ .q-spotlight__layout{ grid-template-columns: minmax(420px, 64%) minmax(260px, 36%); gap: var(--q-gap-lg, 1.25rem); } }

    /* Clamp hero media height (section-scoped). If your card uses a different media class, change selector. */
    [data-section-id="{{ sid }}"] .q-spotlight__hero .q-card__media{
      max-height: var(--q-hero-max-h, 70vh);
      overflow:hidden;
    }

    /* Supporting "carousel" = horizontal strip */
    [data-section-id="{{ sid }}"][data-supporting="carousel"] .q-spotlight__support-inner{
      display:flex;
      gap: var(--q-gap, 1rem);
      overflow-x:auto;
      overflow-y:hidden;
      -webkit-overflow-scrolling: touch;
      scroll-snap-type: x mandatory;
      padding-bottom: .25rem;
    }
    [data-section-id="{{ sid }}"][data-supporting="carousel"] .q-spotlight__support-item{
      flex: 0 0 78%;
      scroll-snap-align: start;
    }
    @media (min-width: 750px){
      [data-section-id="{{ sid }}"][data-supporting="carousel"] .q-spotlight__support-item{ flex-basis: 46%; }
    }
    @media (min-width: 990px){
      [data-section-id="{{ sid }}"][data-supporting="carousel"] .q-spotlight__support-item{ flex-basis: 240px; }
    }

    /* Supporting "list" = vertical rows */
    [data-section-id="{{ sid }}"][data-supporting="list"] .q-spotlight__support-inner{
      display:flex;
      flex-direction:column;
      gap: var(--q-gap, 1rem);
    }
    [data-section-id="{{ sid }}"][data-supporting="list"] .q-spotlight__support-item{
      flex: 0 0 auto;
    }

    /* Supporting "grid" */
    [data-section-id="{{ sid }}"][data-supporting="grid"] .q-spotlight__support-inner{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: var(--q-gap, 1rem);
    }
    @media (min-width: 750px){
      [data-section-id="{{ sid }}"][data-supporting="grid"] .q-spotlight__support-inner{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }

    .q-spotlight__support-nav{ display:flex; gap:.5rem; margin-top: .75rem; justify-content:flex-end; }
    .q-spotlight__btn{ appearance:none; border:1px solid var(--q-border, currentColor); background: transparent; border-radius: 999px; padding:.55rem .85rem; cursor:pointer; }

    /* Simple placeholders */
    .q-ph-card{ border: 1px solid rgba(0,0,0,.08); border-radius: 14px; overflow:hidden; background: rgba(255,255,255,.65); backdrop-filter: blur(8px); }
    .q-ph-media{ aspect-ratio: 1 / 1; background: linear-gradient(90deg, rgba(0,0,0,.04), rgba(0,0,0,.02), rgba(0,0,0,.04)); }
    .q-ph-media--hero{ aspect-ratio: 16 / 9; }
    .q-ph-body{ padding: .85rem; }
    .q-ph-title{ font-weight: 600; font-size: .95rem; }
    .q-ph-price{ margin-top: .25rem; opacity: .7; font-size: .9rem; }

    /* Editorial hero sizing (mid-sized, not full-page) */
    [data-spotlight] .q-spotlight__hero{
      max-width: 960px;
      margin-inline: auto;
    }
    [data-spotlight] .q-spotlight__hero img{
      object-fit: cover;
    }
  </style>

  <script>
    (() => {
      const root = document.querySelector('[data-section-id="{{ sid }}"]');
      if (!root) return;
      if (root.getAttribute('data-supporting') !== 'carousel') return;

      const wrap = root.querySelector('[data-supporting-wrap]');
      const prev = root.querySelector('[data-prev]');
      const next = root.querySelector('[data-next]');
      if (!wrap) return;

      const step = (dir) => {
        const first = wrap.querySelector('[data-supporting-item]');
        const w = first ? first.getBoundingClientRect().width : wrap.getBoundingClientRect().width;
        const gap = parseFloat(getComputedStyle(wrap).gap || '0') || 0;
        const delta = (w + gap) * dir;
        try { wrap.scrollBy({ left: delta, behavior: 'smooth' }); }
        catch(e){ wrap.scrollLeft = wrap.scrollLeft + delta; }
      };

      if (prev) prev.addEventListener('click', () => step(-1));
      if (next) next.addEventListener('click', () => step(1));
    })();
  </script>
</section>

{% schema %}
{
  "name": "Featured - Prod Spotlight",
  "tag": "section",
  "class": "q-featured-product-spotlight-row",
  "settings": [
    { "type": "header", "content": "Header" },
    { "type": "checkbox", "id": "show_header", "label": "Show header", "default": true },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Product Spotlight" },
    { "type": "richtext", "id": "subheading", "label": "Subheading", "default": "<p>A curated row of high-priority products—perfect for promos, bundles, and best-sellers.</p>" },
    { "type": "text", "id": "view_all_label", "label": "View all label", "default": "View all" },
    { "type": "url", "id": "view_all_url", "label": "View all link" },

    { "type": "header", "content": "Background media" },
    {
      "type": "select",
      "id": "bg_mode",
      "label": "Background type",
      "default": "none",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "image", "label": "Image" },
        { "value": "video", "label": "Video" }
      ]
    },
    { "type": "image_picker", "id": "bg_image", "label": "Background image" },
    { "type": "video", "id": "bg_video", "label": "Background video" },
    {
      "type": "select",
      "id": "bg_fit",
      "label": "Background fit",
      "default": "cover",
      "options": [
        { "value": "cover", "label": "Cover" },
        { "value": "contain", "label": "Contain" }
      ]
    },
    {
      "type": "select",
      "id": "bg_position",
      "label": "Background position",
      "default": "center center",
      "options": [
        { "value": "center center", "label": "Center" },
        { "value": "top center", "label": "Top" },
        { "value": "bottom center", "label": "Bottom" },
        { "value": "center left", "label": "Left" },
        { "value": "center right", "label": "Right" }
      ]
    },
    { "type": "color", "id": "bg_overlay_color", "label": "Overlay color", "default": "#FFFFFF" },
    { "type": "range", "id": "bg_overlay_opacity", "label": "Overlay opacity (%)", "min": 0, "max": 90, "step": 5, "default": 25 },
    { "type": "range", "id": "bg_dim", "label": "Dim amount (%)", "min": 0, "max": 80, "step": 5, "default": 0 },
    { "type": "range", "id": "bg_blur", "label": "Blur (px)", "min": 0, "max": 18, "step": 1, "default": 0 },

    { "type": "header", "content": "Source" },
    {
      "type": "select",
      "id": "source_mode",
      "label": "Source mode",
      "default": "manual",
      "options": [
        { "value": "manual", "label": "Manual products" },
        { "value": "collection", "label": "Collection" }
      ]
    },
    { "type": "collection", "id": "collection", "label": "Collection (when source is Collection)" },
    { "type": "product_list", "id": "products", "label": "Products (manual)", "limit": 12 },
    { "type": "range", "id": "max_items", "label": "Max items shown", "min": 3, "max": 12, "step": 1, "default": 8 },

    { "type": "header", "content": "Layout" },
    {
      "type": "select",
      "id": "layout_variant",
      "label": "Layout variant",
      "default": "hero_row",
      "options": [
        { "value": "hero_row", "label": "Hero + supporting row" },
        { "value": "grid", "label": "Simple grid" }
      ]
    },
    {
      "type": "select",
      "id": "supporting_mode",
      "label": "Supporting items (hero layout)",
      "default": "carousel",
      "options": [
        { "value": "carousel", "label": "Carousel (snap)" },
        { "value": "list", "label": "Listing (rows)" },
        { "value": "grid", "label": "Grid" }
      ]
    },
    { "type": "range", "id": "hero_index", "label": "Hero product position (1 = first)", "min": 1, "max": 12, "step": 1, "default": 1 },

    { "type": "header", "content": "Section styling" },
    { "type": "color", "id": "section_bg", "label": "Section background", "default": "transparent" },
    { "type": "color", "id": "section_border", "label": "Section border", "default": "transparent" },
    { "type": "range", "id": "section_radius", "label": "Section radius (px)", "min": 0, "max": 40, "step": 1, "default": 0 },
    { "type": "range", "id": "pad_y", "label": "Padding Y (px)", "min": 0, "max": 120, "step": 4, "default": 0 },
    { "type": "range", "id": "pad_x", "label": "Padding X (px)", "min": 0, "max": 120, "step": 4, "default": 0 },

    { "type": "header", "content": "Card preset" },
    {
      "type": "select",
      "id": "card_preset",
      "label": "Card preset",
      "default": "catalog",
      "options": [
        { "value": "editorial", "label": "Editorial" },
        { "value": "tech", "label": "Tech" },
        { "value": "catalog", "label": "Catalog" },
        { "value": "minimal", "label": "Minimal" },
        { "value": "pill", "label": "Pill" }
      ]
    },
    {
      "type": "select",
      "id": "card_density",
      "label": "Density",
      "default": "compact",
      "options": [
        { "value": "comfortable", "label": "Comfortable" },
        { "value": "compact", "label": "Compact" }
      ]
    },

    { "type": "header", "content": "Media" },
    {
      "type": "select",
      "id": "media_mode",
      "label": "Media mode",
      "default": "single",
      "options": [
        { "value": "single", "label": "Single image" },
        { "value": "swap", "label": "Hover swap" },
        { "value": "scroll", "label": "Scroll gallery" }
      ]
    },
    {
      "type": "select",
      "id": "media_fit",
      "label": "Media fit",
      "default": "cover",
      "options": [
        { "value": "cover", "label": "Cover" },
        { "value": "contain", "label": "Contain" }
      ]
    },
    { "type": "checkbox", "id": "image_zoom", "label": "Image hover zoom", "default": true },
    { "type": "range", "id": "hero_media_ratio", "label": "Hero media ratio (%)", "min": 70, "max": 140, "step": 5, "default": 105 },
    { "type": "range", "id": "support_media_ratio", "label": "Supporting media ratio (%)", "min": 70, "max": 140, "step": 5, "default": 105 },
    { "type": "range", "id": "hero_max_h", "label": "Hero media max height (vh)", "min": 30, "max": 90, "step": 5, "default": 70 },

    { "type": "header", "content": "Hover + actions" },
    {
      "type": "select",
      "id": "hover_treatment",
      "label": "Hover treatment",
      "default": "overlay_actions",
      "options": [
        { "value": "none", "label": "None" },
        { "value": "media_zoom", "label": "Zoom only" },
        { "value": "media_dim", "label": "Dim image" },
        { "value": "overlay_actions", "label": "Overlay actions" },
        { "value": "swap_only", "label": "Swap only" }
      ]
    },
    { "type": "range", "id": "hover_overlay_opacity", "label": "Overlay opacity (%)", "min": 0, "max": 80, "step": 5, "default": 15 },
    {
      "type": "select",
      "id": "hover_actions_visibility",
      "label": "Show hover actions",
      "default": "desktop_only",
      "options": [
        { "value": "always", "label": "Always" },
        { "value": "desktop_only", "label": "Desktop only" },
        { "value": "never", "label": "Never" }
      ]
    },
    {
      "type": "select",
      "id": "actions_layout",
      "label": "Actions layout",
      "default": "stack",
      "options": [
        { "value": "stack", "label": "Stack" },
        { "value": "split", "label": "Split" }
      ]
    },

    { "type": "header", "content": "Typography" },
    { "type": "range", "id": "title_size", "label": "Title size", "min": 12, "max": 22, "step": 1, "default": 16 },
    {
      "type": "select",
      "id": "title_weight",
      "label": "Title weight",
      "default": "600",
      "options": [
        { "value": "400", "label": "400" },
        { "value": "500", "label": "500" },
        { "value": "600", "label": "600" },
        { "value": "700", "label": "700" }
      ]
    },
    { "type": "range", "id": "price_size", "label": "Price size", "min": 12, "max": 20, "step": 1, "default": 15 },
    {
      "type": "select",
      "id": "price_weight",
      "label": "Price weight",
      "default": "600",
      "options": [
        { "value": "400", "label": "400" },
        { "value": "500", "label": "500" },
        { "value": "600", "label": "600" },
        { "value": "700", "label": "700" }
      ]
    },
    {
      "type": "select",
      "id": "title_style",
      "label": "Title style preset",
      "default": "inherit",
      "options": [
        { "value": "inherit", "label": "Inherit" },
        { "value": "coquette", "label": "Coquette (uses --q-font-accent)" }
      ]
    },

    { "type": "header", "content": "Badges" },
    { "type": "checkbox", "id": "show_badges", "label": "Show badges", "default": true },
    { "type": "checkbox", "id": "badge_sale", "label": "Sale badge", "default": true },

    { "type": "header", "content": "Quick add + Quick view" },
    { "type": "checkbox", "id": "enable_quick_add", "label": "Enable quick add", "default": true },
    {
      "type": "select",
      "id": "quick_add_mode",
      "label": "Quick add mode",
      "default": "sizes",
      "options": [
        { "value": "button", "label": "Button" },
        { "value": "icon", "label": "Icon" },
        { "value": "sizes", "label": "Sizes grid" },
        { "value": "dropdown", "label": "Variants dropdown" }
      ]
    },
    { "type": "checkbox", "id": "enable_quick_view", "label": "Enable quick view", "default": true },
    {
      "type": "select",
      "id": "quick_view_mode",
      "label": "Quick view mode",
      "default": "drawer",
      "options": [
        { "value": "drawer", "label": "Drawer" },
        { "value": "modal", "label": "Modal" }
      ]
    },
    {
      "type": "select",
      "id": "quick_view_placement",
      "label": "Quick view placement",
      "default": "overlay",
      "options": [
        { "value": "overlay", "label": "Overlay" },
        { "value": "below_content", "label": "Below content" },
        { "value": "both", "label": "Both" },
        { "value": "none", "label": "None" }
      ]
    },

    { "type": "header", "content": "Action row (bottom buttons)" },
    { "type": "checkbox", "id": "show_action_row", "label": "Show always-visible action row", "default": false },
    { "type": "checkbox", "id": "show_secondary_row_cta", "label": "Show Learn more in row", "default": true },
    { "type": "checkbox", "id": "show_row_quick_view", "label": "Show Quick view in row", "default": true },

    { "type": "header", "content": "Button labels" },
    { "type": "text", "id": "label_add_to_bag", "label": "Primary CTA label", "default": "Add to bag" },
    { "type": "text", "id": "label_learn_more", "label": "Secondary CTA label", "default": "Learn more" },
    { "type": "text", "id": "label_quick_view", "label": "Quick view label", "default": "Quick view" },
    { "type": "text", "id": "label_select_options", "label": "Select options label", "default": "Select options" },
    { "type": "text", "id": "label_sold_out", "label": "Sold out label", "default": "Sold out" }
  ],
  "presets": [
    { "name": "Featured - Product Spotlight Row", "category": "Featured Content" }
  ]
}
{% endschema %}
