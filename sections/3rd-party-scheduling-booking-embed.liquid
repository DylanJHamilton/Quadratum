{% comment %}
  Quadratum — 3rd Party · Scheduling & booking embed (Section)
  • Theme-only embed wrapper for GHL calendars, Calendly, etc.
  • No snippets, no external assets.
  • Renders raw embed_code (do not escape).
  • Single-column layout with optional help link.
{% endcomment %}

{% liquid
  assign s = section.settings
%}

{% if s.enable_section %}
<section
  id="third-party-scheduling-embed-{{ section.id }}"
  class="q-section q-third-party-scheduling-embed q-section--bg-{{ s.background_style }} q-section--width-{{ s.max_width }}"
  aria-label="{{ s.aria_label | escape }}"
  data-q-third-party="scheduling-embed"
>
  <style>
    /* Scoped styles — only affect this section instance */
    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__wrap {
      width: 100%;
      margin-top: var(--q-space-lg, 1.5rem);
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__wrap--center {
      display: flex;
      justify-content: center;
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__wrap--left {
      display: block;
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__surface {
      width: 100%;
      max-width: 100%;
      border-radius: var(--q-radius-xl, 18px);
      border: 1px solid var(--q-border, rgba(17, 17, 17, 0.12));
      background: var(--q-surface, rgba(255, 255, 255, 0.9));
      box-shadow: var(--q-shadow-lg, 0 14px 40px rgba(0,0,0,.08));
      overflow: hidden;
      padding: clamp(14px, 2vw, 22px);
      position: relative;
    }

    /* Subtle “designed” highlight without feeling like raw HTML */
    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__surface::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background: radial-gradient(
        1200px 420px at 20% 0%,
        rgba(255, 255, 255, 0.55),
        rgba(255, 255, 255, 0)
      );
      opacity: 0.75;
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__calendar {
      position: relative;
      z-index: 1;
      width: 100%;
    }

    /* Make common embed patterns look good (Calendly/GHL iframes) */
    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__calendar iframe {
      width: 100% !important;
      max-width: 100%;
      border: 0 !important;
      border-radius: var(--q-radius-lg, 14px);
      background: transparent;
      min-height: var(--q-embed-min-h, 640px);
    }

    /* A lot of providers inject div wrappers; keep them from overflowing */
    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__calendar > * {
      max-width: 100%;
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__help {
      margin-top: var(--q-space-md, 1rem);
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__help-link {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 600;
      text-decoration: none;
      color: inherit;
      opacity: 0.9;
      padding: 0.55rem 0.9rem;
      border-radius: var(--q-radius-pill, 999px);
      border: 1px solid var(--q-border, rgba(17, 17, 17, 0.12));
      background: var(--q-surface-2, rgba(255, 255, 255, 0.7));
      transition: transform 120ms ease, opacity 120ms ease, background 120ms ease;
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__help-link:hover {
      opacity: 1;
      transform: translateY(-1px);
      background: var(--q-surface-2, rgba(255, 255, 255, 0.85));
    }

    #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__help-link:focus-visible {
      outline: 2px solid var(--q-focus, rgba(37, 99, 235, 0.65));
      outline-offset: 3px;
    }

    /* Small screens: reduce padding slightly */
    @media (max-width: 749px) {
      #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__surface {
        padding: 14px;
        border-radius: var(--q-radius-lg, 14px);
      }
      #third-party-scheduling-embed-{{ section.id }} .q-third-party-scheduling-embed__calendar iframe {
        min-height: var(--q-embed-min-h-mobile, 560px);
      }
    }
  </style>

  <div class="q-section__inner">
    {%- comment -%} Header {%- endcomment -%}
    {% if s.kicker != blank or s.heading != blank or s.description != blank %}
      <header class="q-section__header q-section__header--{{ s.content_align }}">
        {% if s.kicker != blank %}
          <p class="q-section__kicker">{{ s.kicker | escape }}</p>
        {% endif %}

        {% if s.heading != blank %}
          <h2 class="q-section__heading">{{ s.heading | escape }}</h2>
        {% endif %}

        {% if s.description != blank %}
          <div class="q-section__body">
            <p>{{ s.description | escape }}</p>
          </div>
        {% endif %}
      </header>
    {% endif %}

    {%- comment -%} Embed container {%- endcomment -%}
    <div class="q-third-party-scheduling-embed__wrap q-third-party-scheduling-embed__wrap--{{ s.content_align }}">
      <div class="q-third-party-scheduling-embed__surface" role="group" aria-label="Scheduling widget">
        <div class="q-third-party-scheduling-embed__calendar">
          {{ s.embed_code }}
        </div>
      </div>
    </div>

    {%- comment -%} Fallback help link {%- endcomment -%}
    {% if s.show_help_link %}
      {% if s.help_url != blank %}
        <div class="q-third-party-scheduling-embed__help q-section__header--{{ s.content_align }}">
          <a href="{{ s.help_url }}" class="q-third-party-scheduling-embed__help-link">
            {{ s.help_text | escape }}
          </a>
        </div>
      {% endif %}
    {% endif %}
  </div>
</section>
{% endif %}

<style>
    /* Typography + spacing polish (scoped) */
#third-party-scheduling-embed-{{ section.id }} .q-section__header {
  display: grid;
  gap: var(--q-space-sm, 0.75rem);
  margin-bottom: var(--q-space-md, 1rem);
}

#third-party-scheduling-embed-{{ section.id }} .q-section__header--center {
  justify-items: center;
  text-align: center;
}

#third-party-scheduling-embed-{{ section.id }} .q-section__header--left {
  justify-items: start;
  text-align: left;
}

#third-party-scheduling-embed-{{ section.id }} .q-section__kicker,
#third-party-scheduling-embed-{{ section.id }} .q-section__heading,
#third-party-scheduling-embed-{{ section.id }} .q-section__body p {
  margin: 0; /* kill default HTML margins */
}

#third-party-scheduling-embed-{{ section.id }} .q-section__body {
  max-width: var(--q-measure, 68ch);
  opacity: 0.92;
}

#third-party-scheduling-embed-{{ section.id }} .q-section__kicker {
  letter-spacing: 0.08em;
  text-transform: uppercase;
  font-weight: 700;
  font-size: 0.85em; /* inherits base size; just scales */
  opacity: 0.85;
}

</style>

{% schema %}
{
  "name": "3rd Party - Booking Embed",
  "tag": "section",
  "class": "q-section q-third-party-scheduling-embed",
  "settings": [
    { "type": "checkbox", "id": "enable_section", "label": "Enable section", "default": true },
    { "type": "text", "id": "kicker", "label": "Kicker", "default": "Schedule your time" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Book your appointment" },
    { "type": "textarea", "id": "description", "label": "Description", "default": "Use the scheduler below to pick a time that works best for you." },
    {
      "type": "textarea",
      "id": "embed_code",
      "label": "Embed code (calendar / booking widget)",
      "default": "<!-- Paste your calendar or booking embed code here (GoHighLevel, Calendly, etc.) -->",
      "info": "Paste the full HTML/JS/iframe snippet from your scheduling provider."
    },
    { "type": "checkbox", "id": "show_help_link", "label": "Show \"Having trouble?\" link", "default": false },
    { "type": "text", "id": "help_text", "label": "Help link text", "default": "Having trouble booking? Contact us directly." },
    { "type": "text", "id": "help_url", "label": "Help link URL", "default": "mailto:hello@example.com" },
    {
      "type": "select",
      "id": "content_align",
      "label": "Content alignment",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" }
      ]
    },
    {
      "type": "select",
      "id": "background_style",
      "label": "Background style",
      "default": "surface",
      "options": [
        { "value": "surface", "label": "Surface" },
        { "value": "contrast", "label": "Contrast" },
        { "value": "brand", "label": "Brand color" }
      ]
    },
    {
      "type": "select",
      "id": "max_width",
      "label": "Content width",
      "default": "md",
      "options": [
        { "value": "sm", "label": "Narrow" },
        { "value": "md", "label": "Medium" },
        { "value": "lg", "label": "Wide" }
      ]
    },
    { "type": "text", "id": "aria_label", "label": "Section aria label", "default": "Scheduling and booking section" }
  ],
  "blocks": [],
  "presets": [
    {
      "name": "3rd Party - Scheduling & Booking Embed",
      "category": "3rd Party Integrations",
      "settings": {
        "kicker": "Book a time",
        "heading": "Schedule your consultation",
        "description": "Pick a date and time that works for you. Our team will confirm your appointment by email.",
        "embed_code": "<!-- Replace this with your GoHighLevel or Calendly embed code. -->"
      }
    }
  ]
}
{% endschema %}
