<!doctype html>
<html lang="{{ request.locale.iso_code }}" class="no-js" data-theme="{{ settings.color_scheme | default: 'default' }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">

    {%- comment -%} Your existing CSS/JS {%- endcomment -%}
    {{ 'theme.css' | asset_url | stylesheet_tag }}
    <style>
      {% render 'theme-tokens' %}
      {% render 'utilities.css' %}
    </style>

    {%- comment -%} Font loading strategy {%- endcomment -%}
    {% assign font_strategy = settings.font_loading | default: 'swap' %}

    {% if font_strategy == 'swap' %}
      <style>@font-face{font-display:swap}</style>
    {% elsif font_strategy == 'fallback' %}
      <style>@font-face{font-display:fallback}</style>
    {% elsif font_strategy == 'async' %}
      {%- comment -%}
        "Async": hint fonts but rely on system fonts first.
        We avoid blocking CSS; if you self-host fonts, preload them:
      {%- endcomment -%}
      {%- comment -%} Example preload hooks (uncomment if you have specific font files) {%- endcomment -%}
      {# <link rel="preload" href="{{ 'inter-var.woff2' | asset_url }}" as="font" type="font/woff2" crossorigin> #}
    {% endif %}


    {%- comment -%} Preconnect hosts (comma-separated in settings) {%- endcomment -%}
    {% if settings.preconnect_hosts %}
      {% assign hosts = settings.preconnect_hosts | split: ',' %}
      {% for host in hosts %}
        {% assign url = host | strip %}
        {% if url != blank %}
          <link rel="preconnect" href="{{ url }}" crossorigin>
        {% endif %}
      {% endfor %}
    {% endif %}


    {{ 'tailwind.css' | asset_url | stylesheet_tag }}
    {{ content_for_header }}

    {%- comment -%} Quadratum base (tokens, helpers, prose) {%- endcomment -%}
    {{ 'q-base.css' | asset_url | stylesheet_tag }}

    {%- comment -%} **Load LAST:** high-specificity global typography override {%- endcomment -%}
   

    {{ 'q-quick-view.css' | asset_url | stylesheet_tag }}
    
  </head>

  <body class="q-typography" {% if settings.enable_dark_mode %}data-theme="light"{% endif %}>
    <a class="skip-to-content" href="#MainContent">{{ 'general.accessibility.skip_to_content' | t }}</a>
    {% section 'header' %}

    <main id="MainContent" role="main">
      {{ content_for_layout }}
    </main>

    {% section 'footer' %}
    {{ content_for_footer }}

    {% render 'q-quick-view-host' %}
    {{ 'q-quick-view.js' | asset_url | script_tag }}

  </body>
</html>
