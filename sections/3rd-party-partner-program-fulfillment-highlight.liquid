{% comment %}
  Quadratum — 3rd Party · Partner Program / Fulfillment Network Highlight (Theme-only)
  File: sections/3rd-party-partner-program-fulfillment-highlight.liquid

  • Static educational content (no API calls)
  • Header (kicker/heading/richtext body) + feature badges + optional CTA row
  • Token-first styling (uses Quadratum CSS vars with safe fallbacks)
  • Scoped CSS so it renders consistently on any template
{% endcomment %}

{%- assign s = section.settings -%}

{%- liquid
  assign inner_max = '1200px'
  case s.max_width
    when 'sm'
      assign inner_max = '720px'
    when 'md'
      assign inner_max = '960px'
    else
      assign inner_max = '1200px'
  endcase

  assign has_header = false
  if s.kicker != blank or s.heading != blank or s.body != blank
    assign has_header = true
  endif

  assign has_badges = false
  for block in section.blocks
    if block.type == 'feature'
      assign has_badges = true
      break
    endif
  endfor

  assign has_cta = false
  if s.cta_enable == true
    if s.cta_label != blank and s.cta_link != blank
      assign has_cta = true
    elsif s.cta_secondary_label != blank and s.cta_secondary_link != blank
      assign has_cta = true
    endif
  endif

  assign should_render = false
  if s.enable_section == true
    if has_header or has_badges or has_cta
      assign should_render = true
    endif
  endif
-%}

{%- if should_render -%}
<section
  id="partner-program-{{ section.id }}"
  class="q-section q-partner-program q-section--bg-{{ s.background_style }} q-section--width-{{ s.max_width }}"
  aria-label="{{ s.aria_label | escape }}"
  data-q-section="partner-program"
>
  <style>
    #partner-program-{{ section.id }}{
      --q-pp-gap: {{ s.badge_gap | default: 20 }}px;

      /* Layout */
      --q-pp-radius: var(--q-radius-lg, var(--q-radius, 16px));
      --q-pp-pad-x: var(--q-pad-x, clamp(16px, 3vw, 32px));
      --q-pp-pad-y: var(--q-pad-y, clamp(22px, 3vw, 44px));

      /* Typography */
      --q-pp-kicker-size: var(--q-kicker-fs, 0.85rem);
      --q-pp-body-size: var(--q-body-fs, 1.02rem);
      --q-pp-heading-size: var(--q-heading-2-fs, clamp(1.7rem, 2.6vw, 2.45rem));
      --q-pp-line: var(--q-body-lh, 1.7);

      /* Colors */
      --q-pp-fg: var(--q-color-fg, var(--color-foreground, #111827));
      --q-pp-bg: var(--q-color-bg, var(--color-background, #ffffff));
      --q-pp-border: var(--q-color-border, rgba(0,0,0,0.10));
      --q-pp-soft: var(--q-color-soft, rgba(0,0,0,0.03));
      --q-pp-shadow: var(--q-shadow-md, 0 10px 30px rgba(0,0,0,0.06));

      --q-pp-success: var(--q-color-success, #16a34a);
      --q-pp-info: var(--q-color-info, #2563eb);

      --q-pp-success-bg: rgba(22,163,74,0.10);
      --q-pp-success-br: rgba(22,163,74,0.22);

      --q-pp-info-bg: rgba(37,99,235,0.10);
      --q-pp-info-br: rgba(37,99,235,0.22);

      --q-pp-chip-bg: var(--q-chip-bg, rgba(0,0,0,0.06));
      --q-pp-chip-br: var(--q-chip-border, rgba(0,0,0,0.12));

      --q-pp-btn-bg: var(--q-btn-primary-bg, var(--q-color-primary, #111827));
      --q-pp-btn-bg-hover: var(--q-btn-primary-bg-hover, #0b1220);
      --q-pp-btn-fg: var(--q-btn-primary-fg, #ffffff);

      --q-pp-link: var(--q-link-muted, rgba(0,0,0,0.72));
      --q-pp-link-hover: var(--q-link, rgba(0,0,0,0.92));
    }

    @supports (color: color-mix(in srgb, #000 10%, transparent)) {
      #partner-program-{{ section.id }}{
        --q-pp-border: var(--q-color-border, color-mix(in srgb, var(--q-pp-fg) 12%, transparent));
        --q-pp-soft: var(--q-color-soft, color-mix(in srgb, var(--q-pp-fg) 4%, transparent));

        --q-pp-success-bg: var(--q-success-soft, color-mix(in srgb, var(--q-pp-success) 14%, transparent));
        --q-pp-success-br: var(--q-success-border, color-mix(in srgb, var(--q-pp-success) 28%, transparent));

        --q-pp-info-bg: var(--q-info-soft, color-mix(in srgb, var(--q-pp-info) 14%, transparent));
        --q-pp-info-br: var(--q-info-border, color-mix(in srgb, var(--q-pp-info) 28%, transparent));

        --q-pp-chip-bg: var(--q-chip-bg, color-mix(in srgb, var(--q-pp-fg) 7%, transparent));
        --q-pp-chip-br: var(--q-chip-border, color-mix(in srgb, var(--q-pp-fg) 14%, transparent));

        --q-pp-link: var(--q-link-muted, color-mix(in srgb, var(--q-pp-fg) 72%, transparent));
        --q-pp-link-hover: var(--q-link, color-mix(in srgb, var(--q-pp-fg) 92%, transparent));
      }
    }

    #partner-program-{{ section.id }}{ color: var(--q-pp-fg); }

    #partner-program-{{ section.id }} .q-section__inner{
      max-width: {{ inner_max }};
      margin-inline: auto;
      padding-inline: var(--q-pp-pad-x);
      padding-block: var(--q-pp-pad-y);
    }

    #partner-program-{{ section.id }} .q-section__header{ margin-bottom: 1.25rem; }
    #partner-program-{{ section.id }} .q-section__header--center{ text-align: center; }
    #partner-program-{{ section.id }} .q-section__header--left{ text-align: left; }

    #partner-program-{{ section.id }} .q-section__kicker{
      margin: 0 0 0.35rem;
      font-size: var(--q-pp-kicker-size);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      opacity: 0.78;
    }

    #partner-program-{{ section.id }} .q-section__heading{
      margin: 0;
      font-size: var(--q-pp-heading-size);
      line-height: 1.12;
      letter-spacing: -0.01em;
    }

    #partner-program-{{ section.id }} .q-section__body.rte{
      margin-top: 0.85rem;
      font-size: var(--q-pp-body-size);
      line-height: var(--q-pp-line);
      max-width: 72ch;
      opacity: 0.92;
    }
    #partner-program-{{ section.id }} .q-section__header--center .q-section__body.rte{ margin-inline: auto; }
    #partner-program-{{ section.id }} .q-section__body.rte p{ margin: 0 0 0.75rem; }
    #partner-program-{{ section.id }} .q-section__body.rte p:last-child{ margin-bottom: 0; }
    #partner-program-{{ section.id }} .q-section__body.rte ul,
    #partner-program-{{ section.id }} .q-section__body.rte ol{
      margin: 0.75rem 0 0;
      padding-left: 1.2rem;
    }
    #partner-program-{{ section.id }} .q-section__body.rte li{ margin: 0.35rem 0; }

    #partner-program-{{ section.id }} .q-partner-program__badges{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: var(--q-pp-gap);
      margin-top: 1rem;
    }

    #partner-program-{{ section.id }} .q-partner-badge{
      border-radius: var(--q-pp-radius);
      padding: 1.25rem 1.25rem 1.15rem;
      border: 1px solid var(--q-pp-border);
      background: var(--q-pp-bg);
      box-shadow: var(--q-pp-shadow);
    }
    #partner-program-{{ section.id }} .q-partner-badge--tone-neutral{
      background: var(--q-pp-bg);
      border-color: var(--q-pp-border);
    }
    #partner-program-{{ section.id }} .q-partner-badge--tone-success{
      background: var(--q-pp-success-bg);
      border-color: var(--q-pp-success-br);
    }
    #partner-program-{{ section.id }} .q-partner-badge--tone-info{
      background: var(--q-pp-info-bg);
      border-color: var(--q-pp-info-br);
    }

    #partner-program-{{ section.id }} .q-partner-badge__icon{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 2.4rem;
      height: 2.4rem;
      border-radius: var(--q-radius-md, 14px);
      background: var(--q-pp-chip-bg);
      border: 1px solid var(--q-pp-chip-br);
      margin-bottom: 0.85rem;
      font-weight: 700;
      letter-spacing: 0.02em;
      line-height: 1;
      user-select: none;
    }

    #partner-program-{{ section.id }} .q-partner-badge__title{
      margin: 0 0 0.35rem;
      font-size: var(--q-h3-fs, 1.06rem);
      line-height: 1.25;
      letter-spacing: -0.01em;
    }

    #partner-program-{{ section.id }} .q-partner-badge__body{
      margin: 0;
      opacity: 0.9;
      line-height: 1.6;
      font-size: var(--q-body-sm-fs, 0.98rem);
    }

    #partner-program-{{ section.id }} .q-partner-program__cta{
      margin-top: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.9rem 1rem;
      padding-top: 1.1rem;
      border-top: 1px solid var(--q-pp-border);
    }
    #partner-program-{{ section.id }} .q-section__cta--center{ justify-content: center; text-align: center; }
    #partner-program-{{ section.id }} .q-section__cta--left{ justify-content: flex-start; text-align: left; }

    #partner-program-{{ section.id }} .q-btn{
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: var(--q-btn-pad-y, 0.85rem) var(--q-btn-pad-x, 1.05rem);
      border-radius: var(--q-btn-radius, var(--q-pp-radius));
      text-decoration: none;
      font-weight: var(--q-btn-fw, 650);
      line-height: 1;
      border: 1px solid transparent;
      transition: transform 140ms ease, background 140ms ease, border-color 140ms ease, opacity 140ms ease;
    }
    #partner-program-{{ section.id }} .q-btn:focus-visible{
      outline: 2px solid currentColor;
      outline-offset: 3px;
    }
    #partner-program-{{ section.id }} .q-btn--primary{
      background: var(--q-pp-btn-bg);
      color: var(--q-pp-btn-fg);
    }
    #partner-program-{{ section.id }} .q-btn--primary:hover{
      background: var(--q-pp-btn-bg-hover);
      transform: translateY(-1px);
    }

    #partner-program-{{ section.id }} .q-link{
      display: inline-flex;
      align-items: center;
      text-decoration: none;
      font-weight: var(--q-link-fw, 600);
    }
    #partner-program-{{ section.id }} .q-link--subtle{ color: var(--q-pp-link); }
    #partner-program-{{ section.id }} .q-link--subtle:hover{
      color: var(--q-pp-link-hover);
      text-decoration: underline;
      text-underline-offset: 3px;
    }
    #partner-program-{{ section.id }} .q-link:focus-visible{
      outline: 2px solid currentColor;
      outline-offset: 3px;
    }

    @media (prefers-reduced-motion: reduce){
      #partner-program-{{ section.id }} .q-btn{ transition: none; }
    }
  </style>

  <div class="q-section__inner">
    {%- if has_header -%}
      <header class="q-section__header q-section__header--{{ s.content_align }}">
        {%- if s.kicker != blank -%}
          <p class="q-section__kicker">{{ s.kicker | escape }}</p>
        {%- endif -%}
        {%- if s.heading != blank -%}
          <h2 class="q-section__heading">{{ s.heading | escape }}</h2>
        {%- endif -%}
        {%- if s.body != blank -%}
          <div class="q-section__body rte">
            {{ s.body }}
          </div>
        {%- endif -%}
      </header>
    {%- endif -%}

    {%- if has_badges -%}
      <div class="q-partner-program__badges" role="list">
        {%- for block in section.blocks -%}
          {%- if block.type == 'feature' -%}
            {%- assign b = block.settings -%}
            <article class="q-partner-badge q-partner-badge--tone-{{ b.tone | default: 'neutral' }}" role="listitem" {{ block.shopify_attributes }}>
              {%- if b.badge_icon_text != blank -%}
                <div class="q-partner-badge__icon" aria-hidden="true">
                  <span>{{ b.badge_icon_text | escape }}</span>
                </div>
              {%- endif -%}
              {%- if b.title != blank -%}
                <h3 class="q-partner-badge__title">{{ b.title | escape }}</h3>
              {%- endif -%}
              {%- if b.body != blank -%}
                <p class="q-partner-badge__body">{{ b.body | escape }}</p>
              {%- endif -%}
            </article>
          {%- endif -%}
        {%- endfor -%}
      </div>
    {%- endif -%}

    {%- if has_cta -%}
      <div class="q-partner-program__cta q-section__cta q-section__cta--{{ s.content_align }}">
        {%- if s.cta_label != blank and s.cta_link != blank -%}
          <a href="{{ s.cta_link }}" class="q-btn q-btn--primary">{{ s.cta_label | escape }}</a>
        {%- endif -%}
        {%- if s.cta_secondary_label != blank and s.cta_secondary_link != blank -%}
          <a href="{{ s.cta_secondary_link }}" class="q-link q-link--subtle">{{ s.cta_secondary_label | escape }}</a>
        {%- endif -%}
      </div>
    {%- endif -%}
  </div>
</section>
{%- endif -%}

{% schema %}
{
  "name": "3P - Partner Highlight",
  "tag": "section",
  "class": "q-section q-partner-program",
  "settings": [
    { "type": "checkbox", "id": "enable_section", "label": "Enable section", "default": true },
    { "type": "text", "id": "kicker", "label": "Kicker", "default": "Partner & fulfillment network" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "How your order is fulfilled" },
    { "type": "richtext", "id": "body", "label": "Description", "default": "<p>We work with a curated network of fulfillment partners and warehouses to deliver your order quickly, reliably, and with full visibility at every step.</p>" },

    { "type": "header", "content": "Layout & styling" },
    {
      "type": "select",
      "id": "content_align",
      "label": "Content alignment",
      "default": "left",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" }
      ]
    },
    {
      "type": "select",
      "id": "background_style",
      "label": "Background style",
      "default": "surface",
      "options": [
        { "value": "surface", "label": "Surface" },
        { "value": "contrast", "label": "Contrast" },
        { "value": "brand", "label": "Brand color" }
      ]
    },
    {
      "type": "select",
      "id": "max_width",
      "label": "Content width",
      "default": "lg",
      "options": [
        { "value": "sm", "label": "Narrow" },
        { "value": "md", "label": "Medium" },
        { "value": "lg", "label": "Wide" }
      ]
    },
    { "type": "range", "id": "badge_gap", "label": "Gap between badges (px)", "min": 8, "max": 40, "step": 2, "default": 20 },
    { "type": "text", "id": "aria_label", "label": "Section aria label", "default": "Partner program and fulfillment network" },

    { "type": "header", "content": "CTA" },
    { "type": "checkbox", "id": "cta_enable", "label": "Show call to action", "default": true },
    { "type": "text", "id": "cta_label", "label": "Primary button label", "default": "View shipping details" },
    { "type": "url", "id": "cta_link", "label": "Primary button link" },
    { "type": "text", "id": "cta_secondary_label", "label": "Secondary link label", "default": "Become a supplier" },
    { "type": "url", "id": "cta_secondary_link", "label": "Secondary link URL" }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Fulfillment badge",
      "settings": [
        { "type": "text", "id": "badge_icon_text", "label": "Icon text (emoji or 2–3 letters)", "default": "US" },
        { "type": "text", "id": "title", "label": "Title", "default": "US warehouses" },
        { "type": "textarea", "id": "body", "label": "Description", "default": "Orders ship from strategically located US warehouses for faster delivery times." },
        {
          "type": "select",
          "id": "tone",
          "label": "Badge tone",
          "default": "neutral",
          "options": [
            { "value": "neutral", "label": "Neutral" },
            { "value": "success", "label": "Success" },
            { "value": "info", "label": "Info" }
          ]
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Partner program & fulfillment",
      "category": "3rd Party Integrations",
      "blocks": [
        { "type": "feature" },
        { "type": "feature" },
        { "type": "feature" }
      ]
    }
  ]
}
{% endschema %}
